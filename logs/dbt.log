

============================== 2023-04-05 10:40:36.428293 | 5cbaf153-a1d6-4782-bbe3-a7386de4ff94 ==============================
[0m10:40:36.428293 [info ] [MainThread]: Running with dbt=1.4.5
[0m10:40:36.429313 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m10:40:36.430294 [debug] [MainThread]: Tracking: tracking
[0m10:40:36.492418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4FCEEA250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4FCE72E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4FD2C7FD0>]}
[0m10:40:36.511981 [debug] [MainThread]: Executing "git --help"
[0m10:40:36.574074 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:40:36.574794 [debug] [MainThread]: STDERR: "b''"
[0m10:40:36.574794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4FD3230D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4FD3238D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4FD323790>]}
[0m10:40:36.575834 [debug] [MainThread]: Flushing usage events


============================== 2023-04-05 10:43:10.982947 | 5f79732d-644a-46b7-8807-86c9803d5503 ==============================
[0m10:43:10.982947 [info ] [MainThread]: Running with dbt=1.4.5
[0m10:43:10.985820 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m10:43:10.986762 [debug] [MainThread]: Tracking: tracking
[0m10:43:11.055651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CDABF593D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CDABFF4390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CDABF22C50>]}
[0m10:43:11.070515 [debug] [MainThread]: Executing "git --help"
[0m10:43:11.133882 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:43:11.134880 [debug] [MainThread]: STDERR: "b''"
[0m10:43:11.135883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CDA70FB490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CDABF5A5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CDABF5B650>]}
[0m10:43:11.136418 [debug] [MainThread]: Flushing usage events


============================== 2023-04-05 10:44:10.182664 | 2163c77a-2bf5-4bb5-bd25-48ad7de052b7 ==============================
[0m10:44:10.182664 [info ] [MainThread]: Running with dbt=1.4.5
[0m10:44:10.185164 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m10:44:10.186166 [debug] [MainThread]: Tracking: tracking
[0m10:44:10.259280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96843A890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96843AB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E968224BD0>]}
[0m10:44:10.328183 [debug] [MainThread]: Executing "git --help"
[0m10:44:10.404323 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:44:10.405473 [debug] [MainThread]: STDERR: "b''"
[0m10:44:10.407676 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:44:10.409079 [debug] [MainThread]: Using postgres connection "debug"
[0m10:44:10.409828 [debug] [MainThread]: On debug: select 1 as id
[0m10:44:10.410411 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:10.508587 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m10:44:10.509671 [debug] [MainThread]: On debug: Close
[0m10:44:10.511022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E968CFAE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E968D07350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E968D94B50>]}
[0m10:44:10.511525 [debug] [MainThread]: Flushing usage events
[0m10:44:10.918389 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-04-05 11:12:04.843652 | 9c0de3a5-5f6f-46a0-9005-3f06dba71b94 ==============================
[0m11:12:04.843652 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:12:04.846083 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['customers.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:12:04.846083 [debug] [MainThread]: Tracking: tracking
[0m11:12:04.898648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9D62E7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9D5C03990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9D6307450>]}
[0m11:12:04.917587 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:12:04.919430 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:12:04.920367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9c0de3a5-5f6f-46a0-9005-3f06dba71b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9D5CE8350>]}
[0m11:12:06.391671 [debug] [MainThread]: 1699: static parser successfully parsed compute\final_model-210923-113810.sql
[0m11:12:06.400949 [debug] [MainThread]: 1699: static parser successfully parsed publish\customer_orders_step_6-210923-113810.sql
[0m11:12:06.403942 [debug] [MainThread]: 1699: static parser successfully parsed staging\customers.sql
[0m11:12:06.423977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9D6475C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9D643B450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9D647FF50>]}
[0m11:12:06.424632 [debug] [MainThread]: Flushing usage events
[0m11:12:06.952660 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.upgrade_skills.final_model-210923-113810' (models\compute\final_model-210923-113810.sql) depends on a node named 'int_orders' which was not found


============================== 2023-04-05 11:15:02.696084 | 937db9c2-1af2-46dc-9d39-c8c7bab35702 ==============================
[0m11:15:02.696084 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:15:02.699083 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['customers.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:15:02.699083 [debug] [MainThread]: Tracking: tracking
[0m11:15:02.759623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B6E0AB750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B6DDE8F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B6E0B4050>]}
[0m11:15:02.777877 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:15:02.779005 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:15:02.779779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '937db9c2-1af2-46dc-9d39-c8c7bab35702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B6D70BF50>]}
[0m11:15:04.309740 [debug] [MainThread]: 1699: static parser successfully parsed compute\final_model-210923-113810.sql
[0m11:15:04.320872 [debug] [MainThread]: 1699: static parser successfully parsed compute\int_orders-210923-112800.sql
[0m11:15:04.325381 [debug] [MainThread]: 1699: static parser successfully parsed publish\customer_orders_step_6-210923-113810.sql
[0m11:15:04.331534 [debug] [MainThread]: 1699: static parser successfully parsed publish\fct_customer_orders-210923-112800.sql
[0m11:15:04.334556 [debug] [MainThread]: 1699: static parser successfully parsed staging\customers.sql
[0m11:15:04.337336 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__orders-210923-112800.sql
[0m11:15:04.357913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B6E1D3FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B6E13B450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B6E1D3F90>]}
[0m11:15:04.358413 [debug] [MainThread]: Flushing usage events
[0m11:15:04.949111 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.upgrade_skills.final_model-210923-113810' (models\compute\final_model-210923-113810.sql) depends on a node named 'int_orders' which was not found


============================== 2023-04-05 11:16:19.165219 | 7aa08f19-e0bb-45ec-9a5d-1f5aa5b1e8ff ==============================
[0m11:16:19.165219 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:16:19.166911 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['customers.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:16:19.167941 [debug] [MainThread]: Tracking: tracking
[0m11:16:19.222121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFEC784250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFED6AA190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFED51B390>]}
[0m11:16:19.234703 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:16:19.235742 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:16:19.235742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7aa08f19-e0bb-45ec-9a5d-1f5aa5b1e8ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFED689210>]}
[0m11:16:19.735628 [debug] [MainThread]: 1699: static parser successfully parsed compute\final_model.sql
[0m11:16:19.747667 [debug] [MainThread]: 1699: static parser successfully parsed compute\int_orders.sql
[0m11:16:19.750572 [debug] [MainThread]: 1699: static parser successfully parsed publish\customer_orders_step_6-210923-113810.sql
[0m11:16:19.752649 [debug] [MainThread]: 1699: static parser successfully parsed publish\fct_customer_orders-210923-112800.sql
[0m11:16:19.756647 [debug] [MainThread]: 1699: static parser successfully parsed staging\customers.sql
[0m11:16:19.759650 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__orders.sql
[0m11:16:19.777652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFED721090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFE781BF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFED775710>]}
[0m11:16:19.778666 [debug] [MainThread]: Flushing usage events
[0m11:16:20.312194 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.upgrade_skills.final_model' (models\compute\final_model.sql) depends on a node named 'stg_jaffle_shop__customers' which was not found


============================== 2023-04-05 11:19:09.881813 | 95cf28a8-db4e-4991-a6fe-c8593feda8eb ==============================
[0m11:19:09.881813 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:19:09.883812 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['customers.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:19:09.883812 [debug] [MainThread]: Tracking: tracking
[0m11:19:09.938008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D5515110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D475ABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D370D290>]}
[0m11:19:09.948204 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:19:09.949797 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:19:09.950438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '95cf28a8-db4e-4991-a6fe-c8593feda8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D54D6F10>]}
[0m11:19:10.497073 [debug] [MainThread]: 1699: static parser successfully parsed compute\final_model.sql
[0m11:19:10.508691 [debug] [MainThread]: 1699: static parser successfully parsed compute\int_orders.sql
[0m11:19:10.512691 [debug] [MainThread]: 1699: static parser successfully parsed publish\customer_orders_step_6-210923-113810.sql
[0m11:19:10.515690 [debug] [MainThread]: 1699: static parser successfully parsed publish\fct_customer_orders-210923-112800.sql
[0m11:19:10.520211 [debug] [MainThread]: 1699: static parser successfully parsed staging\customers.sql
[0m11:19:10.525231 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__customers.sql
[0m11:19:10.528230 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__orders.sql
[0m11:19:10.580160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D5674B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D567FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D5636990>]}
[0m11:19:10.582677 [debug] [MainThread]: Flushing usage events
[0m11:19:11.077707 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.upgrade_skills.int_orders' (models\compute\int_orders.sql) depends on a node named 'stg_stripe__payments' which was not found


============================== 2023-04-05 11:22:26.678353 | d23487c1-6c3a-4969-a09e-0005c1aec08b ==============================
[0m11:22:26.678353 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:22:26.680048 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['customers.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:22:26.680048 [debug] [MainThread]: Tracking: tracking
[0m11:22:26.767009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A69015490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A69000F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A68A06D90>]}
[0m11:22:26.777520 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:22:26.779284 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:22:26.780285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd23487c1-6c3a-4969-a09e-0005c1aec08b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A68DD24D0>]}
[0m11:22:27.260798 [debug] [MainThread]: 1699: static parser successfully parsed compute\final_model.sql
[0m11:22:27.274298 [debug] [MainThread]: 1699: static parser successfully parsed compute\int_orders.sql
[0m11:22:27.278299 [debug] [MainThread]: 1699: static parser successfully parsed publish\customer_orders_step_6-210923-113810.sql
[0m11:22:27.282817 [debug] [MainThread]: 1699: static parser successfully parsed publish\fct_customer_orders-210923-112800.sql
[0m11:22:27.286112 [debug] [MainThread]: 1699: static parser successfully parsed staging\customers.sql
[0m11:22:27.291148 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__customers.sql
[0m11:22:27.295930 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__orders.sql
[0m11:22:27.301271 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_stripe__payments.sql
[0m11:22:27.358645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A6829C3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A69182610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A69159B50>]}
[0m11:22:27.359644 [debug] [MainThread]: Flushing usage events
[0m11:22:27.798383 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.upgrade_skills.stg_stripe__payments' (models\staging\stg_stripe__payments.sql) depends on a source named 'stripe.payments' which was not found


============================== 2023-04-05 11:22:49.563346 | e77d0f74-6d36-47fe-9828-e586e3507b0d ==============================
[0m11:22:49.563346 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:22:49.564356 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['customers.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:22:49.565332 [debug] [MainThread]: Tracking: tracking
[0m11:22:49.620140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EF1807DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EF1805CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EF18AA450>]}
[0m11:22:49.629956 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:22:49.631479 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:22:49.632203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e77d0f74-6d36-47fe-9828-e586e3507b0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EF0A489D0>]}
[0m11:22:50.051879 [debug] [MainThread]: 1699: static parser successfully parsed compute\final_model.sql
[0m11:22:50.065982 [debug] [MainThread]: 1699: static parser successfully parsed compute\int_orders.sql
[0m11:22:50.068738 [debug] [MainThread]: 1699: static parser successfully parsed publish\customer_orders_step_6-210923-113810.sql
[0m11:22:50.072737 [debug] [MainThread]: 1699: static parser successfully parsed publish\fct_customer_orders-210923-112800.sql
[0m11:22:50.075980 [debug] [MainThread]: 1699: static parser successfully parsed staging\customers.sql
[0m11:22:50.078981 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__customers.sql
[0m11:22:50.082007 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__orders.sql
[0m11:22:50.084805 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_stripe__payments.sql
[0m11:22:50.118022 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_snow.compute
- models.dbt_snow.published
- models.dbt_snow.staging
[0m11:22:50.123539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e77d0f74-6d36-47fe-9828-e586e3507b0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EF190A710>]}
[0m11:22:50.131453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e77d0f74-6d36-47fe-9828-e586e3507b0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EF19A17D0>]}
[0m11:22:50.132686 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:22:50.133389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e77d0f74-6d36-47fe-9828-e586e3507b0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EF199BC50>]}
[0m11:22:50.135925 [info ] [MainThread]: 
[0m11:22:50.139552 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:22:50.142430 [debug] [ThreadPool]: Acquiring new postgres connection 'list_pc_dbt_db'
[0m11:22:50.156910 [debug] [ThreadPool]: Using postgres connection "list_pc_dbt_db"
[0m11:22:50.157465 [debug] [ThreadPool]: On list_pc_dbt_db: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "postgres", "connection_name": "list_pc_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m11:22:50.157956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:50.255852 [debug] [ThreadPool]: SQL status: SELECT 8 in 0 seconds
[0m11:22:50.256853 [debug] [ThreadPool]: On list_pc_dbt_db: Close
[0m11:22:50.260190 [debug] [ThreadPool]: Acquiring new postgres connection 'list_pc_dbt_db_mms'
[0m11:22:50.264194 [debug] [ThreadPool]: Using postgres connection "list_pc_dbt_db_mms"
[0m11:22:50.265191 [debug] [ThreadPool]: On list_pc_dbt_db_mms: BEGIN
[0m11:22:50.265191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:50.344383 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m11:22:50.344881 [debug] [ThreadPool]: Using postgres connection "list_pc_dbt_db_mms"
[0m11:22:50.345729 [debug] [ThreadPool]: On list_pc_dbt_db_mms: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "postgres", "connection_name": "list_pc_dbt_db_mms"} */
select
      'pc_dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mms'
    union all
    select
      'pc_dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mms'
  
[0m11:22:50.353748 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m11:22:50.355746 [debug] [ThreadPool]: On list_pc_dbt_db_mms: ROLLBACK
[0m11:22:50.356646 [debug] [ThreadPool]: On list_pc_dbt_db_mms: Close
[0m11:22:50.362527 [debug] [MainThread]: Using postgres connection "master"
[0m11:22:50.363092 [debug] [MainThread]: On master: BEGIN
[0m11:22:50.363696 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:22:50.445458 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:22:50.446458 [debug] [MainThread]: Using postgres connection "master"
[0m11:22:50.446458 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "postgres", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:22:50.455573 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m11:22:50.456571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e77d0f74-6d36-47fe-9828-e586e3507b0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EF0A548D0>]}
[0m11:22:50.457573 [debug] [MainThread]: On master: ROLLBACK
[0m11:22:50.457573 [debug] [MainThread]: Using postgres connection "master"
[0m11:22:50.458460 [debug] [MainThread]: On master: BEGIN
[0m11:22:50.458460 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:22:50.459478 [debug] [MainThread]: On master: COMMIT
[0m11:22:50.459478 [debug] [MainThread]: Using postgres connection "master"
[0m11:22:50.459478 [debug] [MainThread]: On master: COMMIT
[0m11:22:50.460578 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:22:50.460578 [debug] [MainThread]: On master: Close
[0m11:22:50.461973 [info ] [MainThread]: Concurrency: 2 threads (target='postgres')
[0m11:22:50.462545 [info ] [MainThread]: 
[0m11:22:50.545239 [debug] [Thread-1 (]: Began running node model.upgrade_skills.customers
[0m11:22:50.546449 [info ] [Thread-1 (]: 1 of 1 START sql view model mms.customers ...................................... [RUN]
[0m11:22:50.547591 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.upgrade_skills.customers'
[0m11:22:50.548337 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.customers
[0m11:22:50.551984 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.customers"
[0m11:22:50.555551 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customers (compile): 2023-04-05 11:22:50.548954 => 2023-04-05 11:22:50.555551
[0m11:22:50.556552 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.customers
[0m11:22:50.620884 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.customers"
[0m11:22:50.624471 [debug] [Thread-1 (]: Using postgres connection "model.upgrade_skills.customers"
[0m11:22:50.624969 [debug] [Thread-1 (]: On model.upgrade_skills.customers: BEGIN
[0m11:22:50.625342 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:22:50.710897 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:22:50.710897 [debug] [Thread-1 (]: Using postgres connection "model.upgrade_skills.customers"
[0m11:22:50.710897 [debug] [Thread-1 (]: On model.upgrade_skills.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "postgres", "node_id": "model.upgrade_skills.customers"} */

  create view "pc_dbt_db"."mms"."customers__dbt_tmp" as (
    SELECT 
    *
FROM "raw"."jaffle_shop"."customers"
  );
[0m11:22:50.715901 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  les rÃ©fÃ©rences entre bases de donnÃ©es ne sont pas implÃ©mentÃ©es : Â« raw.jaffle_shop.customers Â»
LINE 6: FROM "raw"."jaffle_shop"."customers"
             ^

[0m11:22:50.716712 [debug] [Thread-1 (]: On model.upgrade_skills.customers: ROLLBACK
[0m11:22:50.717213 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customers (execute): 2023-04-05 11:22:50.557053 => 2023-04-05 11:22:50.717213
[0m11:22:50.718171 [debug] [Thread-1 (]: On model.upgrade_skills.customers: Close
[0m11:22:50.825845 [debug] [Thread-1 (]: Database Error in model customers (models\staging\customers.sql)
  ERREUR:  les rÃ©fÃ©rences entre bases de donnÃ©es ne sont pas implÃ©mentÃ©es : Â« raw.jaffle_shop.customers Â»
  LINE 6: FROM "raw"."jaffle_shop"."customers"
               ^
  compiled Code at target\run\upgrade_skills\models\staging\customers.sql
[0m11:22:50.826727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e77d0f74-6d36-47fe-9828-e586e3507b0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EF195E810>]}
[0m11:22:50.827725 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model mms.customers ............................. [[31mERROR[0m in 0.28s]
[0m11:22:50.830053 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.customers
[0m11:22:50.832114 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:22:50.832532 [debug] [MainThread]: Using postgres connection "master"
[0m11:22:50.833103 [debug] [MainThread]: On master: BEGIN
[0m11:22:50.833604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:22:50.936772 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:22:50.937774 [debug] [MainThread]: On master: COMMIT
[0m11:22:50.938472 [debug] [MainThread]: Using postgres connection "master"
[0m11:22:50.938949 [debug] [MainThread]: On master: COMMIT
[0m11:22:50.939347 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:22:50.940348 [debug] [MainThread]: On master: Close
[0m11:22:50.941271 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:22:50.941982 [debug] [MainThread]: Connection 'list_pc_dbt_db' was properly closed.
[0m11:22:50.942482 [debug] [MainThread]: Connection 'list_pc_dbt_db_mms' was properly closed.
[0m11:22:50.942752 [debug] [MainThread]: Connection 'model.upgrade_skills.customers' was properly closed.
[0m11:22:50.943568 [info ] [MainThread]: 
[0m11:22:50.945043 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m11:22:50.945660 [debug] [MainThread]: Command end result
[0m11:22:50.952735 [info ] [MainThread]: 
[0m11:22:50.953734 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:22:50.954233 [info ] [MainThread]: 
[0m11:22:50.954735 [error] [MainThread]: [33mDatabase Error in model customers (models\staging\customers.sql)[0m
[0m11:22:50.955268 [error] [MainThread]:   ERREUR:  les rÃ©fÃ©rences entre bases de donnÃ©es ne sont pas implÃ©mentÃ©es : Â« raw.jaffle_shop.customers Â»
[0m11:22:50.956286 [error] [MainThread]:   LINE 6: FROM "raw"."jaffle_shop"."customers"
[0m11:22:50.956786 [error] [MainThread]:                ^
[0m11:22:50.957385 [error] [MainThread]:   compiled Code at target\run\upgrade_skills\models\staging\customers.sql
[0m11:22:50.958012 [info ] [MainThread]: 
[0m11:22:50.958513 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:22:50.959460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EF15DB910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EF1906650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011EF19015D0>]}
[0m11:22:50.959962 [debug] [MainThread]: Flushing usage events


============================== 2023-04-05 11:24:27.078923 | ef4e5981-69de-43b5-bc22-dfad94b66c90 ==============================
[0m11:24:27.078923 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:24:27.081953 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['customers.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:24:27.082454 [debug] [MainThread]: Tracking: tracking
[0m11:24:27.083452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015167EC6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015166A1F310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015167EC7610>]}
[0m11:24:27.094837 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:24:27.114463 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:24:27.115053 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m11:24:27.115937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ef4e5981-69de-43b5-bc22-dfad94b66c90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015167FC7CD0>]}
[0m11:24:27.829113 [debug] [MainThread]: 1699: static parser successfully parsed compute\final_model.sql
[0m11:24:27.839976 [debug] [MainThread]: 1699: static parser successfully parsed compute\int_orders.sql
[0m11:24:27.846593 [debug] [MainThread]: 1699: static parser successfully parsed publish\customer_orders_step_6-210923-113810.sql
[0m11:24:27.851596 [debug] [MainThread]: 1699: static parser successfully parsed publish\fct_customer_orders-210923-112800.sql
[0m11:24:27.855624 [debug] [MainThread]: 1699: static parser successfully parsed staging\customers.sql
[0m11:24:27.861598 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__customers.sql
[0m11:24:27.866589 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__orders.sql
[0m11:24:27.871591 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_stripe__payments.sql
[0m11:24:27.909161 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_snow.staging
- models.dbt_snow.compute
- models.dbt_snow.published
[0m11:24:27.914875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef4e5981-69de-43b5-bc22-dfad94b66c90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015167F70350>]}
[0m11:24:27.922309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef4e5981-69de-43b5-bc22-dfad94b66c90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015167F7DA90>]}
[0m11:24:27.923294 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 306 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:24:27.923918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef4e5981-69de-43b5-bc22-dfad94b66c90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015167EE2B50>]}
[0m11:24:27.925420 [info ] [MainThread]: 
[0m11:24:27.927700 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:24:27.929533 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m11:24:27.940552 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m11:24:27.941552 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m11:24:27.941552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:35.250610 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m11:24:35.250610 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:24:35.251980 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m11:24:35.252480 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:24:35.253060 [debug] [ThreadPool]: On list_PC_DBT_DB: No close available on handle
[0m11:24:35.255002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:24:35.255502 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was properly closed.
[0m11:24:35.256005 [info ] [MainThread]: 
[0m11:24:35.257001 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 7.33 seconds (7.33s).
[0m11:24:35.257528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015167F771D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015167F3E650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015168877CD0>]}
[0m11:24:35.258029 [debug] [MainThread]: Flushing usage events
[0m11:24:35.698210 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "PC_DBT_DB"
  Database Error
    250001: Could not connect to Snowflake backend after 0 attempt(s).Aborting


============================== 2023-04-05 11:30:37.146912 | 2c1c11a0-285c-4a71-9c64-d1403009a893 ==============================
[0m11:30:37.146912 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:30:37.148898 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['customers.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:30:37.149963 [debug] [MainThread]: Tracking: tracking
[0m11:30:37.150961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002182F2DF4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002182F2DF310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021830827950>]}
[0m11:30:37.159807 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:30:37.243508 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:30:37.243977 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:30:37.244498 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_snow.staging
- models.dbt_snow.compute
- models.dbt_snow.published
[0m11:30:37.253705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c1c11a0-285c-4a71-9c64-d1403009a893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002182FA24150>]}
[0m11:30:37.260124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c1c11a0-285c-4a71-9c64-d1403009a893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002183082E0D0>]}
[0m11:30:37.260614 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 306 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:30:37.261386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c1c11a0-285c-4a71-9c64-d1403009a893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002182FBA0E90>]}
[0m11:30:37.261896 [info ] [MainThread]: 
[0m11:30:37.264613 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:30:37.266343 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m11:30:37.282782 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m11:30:37.283765 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m11:30:37.284279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:42.217110 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m11:30:42.217476 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:30:42.218238 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m11:30:42.218238 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:30:42.219421 [debug] [ThreadPool]: On list_PC_DBT_DB: No close available on handle
[0m11:30:42.221738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:42.222774 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was properly closed.
[0m11:30:42.223331 [info ] [MainThread]: 
[0m11:30:42.224337 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 4.96 seconds (4.96s).
[0m11:30:42.224337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218308DB410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002183086FE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002183086FAD0>]}
[0m11:30:42.225389 [debug] [MainThread]: Flushing usage events
[0m11:30:42.788124 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "PC_DBT_DB"
  Database Error
    250001: Could not connect to Snowflake backend after 0 attempt(s).Aborting


============================== 2023-04-05 11:32:31.855810 | e76b11f9-e109-4ccf-a9b3-fda05e9d4341 ==============================
[0m11:32:31.855810 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:32:31.857725 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['customers.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:32:31.857725 [debug] [MainThread]: Tracking: tracking
[0m11:32:31.858723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E47989450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E45D48390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E47906F50>]}
[0m11:32:31.870761 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:32:31.952480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:32:31.952480 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:32:31.953490 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_snow.compute
- models.dbt_snow.staging
- models.dbt_snow.published
[0m11:32:31.959853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e76b11f9-e109-4ccf-a9b3-fda05e9d4341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E45D81690>]}
[0m11:32:31.965981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e76b11f9-e109-4ccf-a9b3-fda05e9d4341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E479A7FD0>]}
[0m11:32:31.967143 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 306 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:32:31.967645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e76b11f9-e109-4ccf-a9b3-fda05e9d4341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E45DF4750>]}
[0m11:32:31.968705 [info ] [MainThread]: 
[0m11:32:31.969997 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:32:31.972108 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m11:32:31.986596 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m11:32:31.986596 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m11:32:31.986596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:37.155905 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m11:32:37.156555 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:32:37.157319 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m11:32:37.158354 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:32:37.158854 [debug] [ThreadPool]: On list_PC_DBT_DB: No close available on handle
[0m11:32:37.161853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:37.162352 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was properly closed.
[0m11:32:37.163353 [info ] [MainThread]: 
[0m11:32:37.163852 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 5.19 seconds (5.19s).
[0m11:32:37.164854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E479BF610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E479A8C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E479A8B90>]}
[0m11:32:37.165356 [debug] [MainThread]: Flushing usage events
[0m11:32:37.624571 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "PC_DBT_DB"
  Database Error
    250001: Could not connect to Snowflake backend after 0 attempt(s).Aborting


============================== 2023-04-05 11:36:50.894506 | 1a2c16de-b3ea-48b6-81a3-91fbe902769a ==============================
[0m11:36:50.894506 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:36:50.896842 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['customers.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:36:50.896842 [debug] [MainThread]: Tracking: tracking
[0m11:36:50.897803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279F4D307D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279F3480310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279F4DA2B90>]}
[0m11:36:50.922651 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:36:50.945891 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:36:50.947200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1a2c16de-b3ea-48b6-81a3-91fbe902769a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279F4ED2910>]}
[0m11:36:52.832299 [debug] [MainThread]: 1699: static parser successfully parsed compute\final_model.sql
[0m11:36:52.843308 [debug] [MainThread]: 1699: static parser successfully parsed compute\int_orders.sql
[0m11:36:52.848307 [debug] [MainThread]: 1699: static parser successfully parsed publish\customer_orders_step_6-210923-113810.sql
[0m11:36:52.856409 [debug] [MainThread]: 1699: static parser successfully parsed publish\fct_customer_orders-210923-112800.sql
[0m11:36:52.862616 [debug] [MainThread]: 1699: static parser successfully parsed staging\customers.sql
[0m11:36:52.867613 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__customers.sql
[0m11:36:52.872246 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__orders.sql
[0m11:36:52.876245 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_stripe__payments.sql
[0m11:36:52.917829 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_snow.staging
- models.dbt_snow.published
- models.dbt_snow.compute
[0m11:36:52.923543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a2c16de-b3ea-48b6-81a3-91fbe902769a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279F4E81950>]}
[0m11:36:52.931407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a2c16de-b3ea-48b6-81a3-91fbe902769a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279F4E5A290>]}
[0m11:36:52.932408 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 306 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:36:52.932408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a2c16de-b3ea-48b6-81a3-91fbe902769a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279F4E3F650>]}
[0m11:36:52.934420 [info ] [MainThread]: 
[0m11:36:52.936428 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:36:52.938421 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m11:36:52.954410 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m11:36:52.955414 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m11:36:52.955414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:59.619197 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m11:36:59.619776 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:36:59.619776 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m11:36:59.619776 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:36:59.620644 [debug] [ThreadPool]: On list_PC_DBT_DB: No close available on handle
[0m11:36:59.621030 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:59.622069 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was properly closed.
[0m11:36:59.622272 [info ] [MainThread]: 
[0m11:36:59.622852 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 6.69 seconds (6.69s).
[0m11:36:59.623453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279F4E59210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279F4E59F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279F4E5B850>]}
[0m11:36:59.624235 [debug] [MainThread]: Flushing usage events
[0m11:37:00.053979 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "PC_DBT_DB"
  Database Error
    250001: Could not connect to Snowflake backend after 0 attempt(s).Aborting


============================== 2023-04-05 11:38:03.406709 | 97685d9b-843a-4a05-8f92-c7aeccc51c27 ==============================
[0m11:38:03.406709 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:38:03.408709 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['customers.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:38:03.408709 [debug] [MainThread]: Tracking: tracking
[0m11:38:03.409745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226F8EA610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226F8EAB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226EA07C10>]}
[0m11:38:03.417722 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:38:03.438718 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:38:03.439719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '97685d9b-843a-4a05-8f92-c7aeccc51c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226F9D24D0>]}
[0m11:38:04.095932 [debug] [MainThread]: 1699: static parser successfully parsed compute\final_model.sql
[0m11:38:04.106572 [debug] [MainThread]: 1699: static parser successfully parsed compute\int_orders.sql
[0m11:38:04.109557 [debug] [MainThread]: 1699: static parser successfully parsed publish\customer_orders_step_6-210923-113810.sql
[0m11:38:04.111567 [debug] [MainThread]: 1699: static parser successfully parsed publish\fct_customer_orders-210923-112800.sql
[0m11:38:04.115691 [debug] [MainThread]: 1699: static parser successfully parsed staging\customers.sql
[0m11:38:04.117684 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__customers.sql
[0m11:38:04.120684 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__orders.sql
[0m11:38:04.122688 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_stripe__payments.sql
[0m11:38:04.161135 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_snow.compute
- models.dbt_snow.staging
- models.dbt_snow.published
[0m11:38:04.166125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97685d9b-843a-4a05-8f92-c7aeccc51c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226F9BCFD0>]}
[0m11:38:04.172811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97685d9b-843a-4a05-8f92-c7aeccc51c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226F95BB10>]}
[0m11:38:04.172811 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 306 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:38:04.174026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97685d9b-843a-4a05-8f92-c7aeccc51c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226F3B4350>]}
[0m11:38:04.174705 [info ] [MainThread]: 
[0m11:38:04.176862 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:38:04.177980 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m11:38:04.189003 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m11:38:04.189003 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m11:38:04.189998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:05.740965 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2 seconds
[0m11:38:05.743701 [debug] [ThreadPool]: On list_PC_DBT_DB: Close
[0m11:38:05.996947 [debug] [ThreadPool]: Acquiring new snowflake connection 'create_PC_DBT_DB_DBT_PC_ATOS'
[0m11:38:05.997945 [debug] [ThreadPool]: Acquiring new snowflake connection 'create_PC_DBT_DB_DBT_PC_ATOS'
[0m11:38:05.998946 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='pc_dbt_db', schema='dbt_pc_atos', identifier=None)"
[0m11:38:06.003255 [debug] [ThreadPool]: Using snowflake connection "create_PC_DBT_DB_DBT_PC_ATOS"
[0m11:38:06.004338 [debug] [ThreadPool]: On create_PC_DBT_DB_DBT_PC_ATOS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "create_PC_DBT_DB_DBT_PC_ATOS"} */
create schema if not exists PC_DBT_DB.DBT_PC_ATOS
[0m11:38:06.004689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:07.275916 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1 seconds
[0m11:38:07.277371 [debug] [ThreadPool]: On create_PC_DBT_DB_DBT_PC_ATOS: Close
[0m11:38:07.580857 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_PC_ATOS'
[0m11:38:07.585860 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_PC_ATOS"
[0m11:38:07.586860 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB_DBT_PC_ATOS"} */
show terse objects in PC_DBT_DB.DBT_PC_ATOS
[0m11:38:07.586860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:08.559432 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1 seconds
[0m11:38:08.561429 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS: Close
[0m11:38:08.821590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97685d9b-843a-4a05-8f92-c7aeccc51c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226FB457D0>]}
[0m11:38:08.822130 [info ] [MainThread]: Concurrency: 2 threads (target='snow')
[0m11:38:08.824177 [info ] [MainThread]: 
[0m11:38:08.911632 [debug] [Thread-1 (]: Began running node model.upgrade_skills.customers
[0m11:38:08.912842 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_PC_ATOS.customers .............................. [RUN]
[0m11:38:08.913420 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.customers'
[0m11:38:08.914552 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.customers
[0m11:38:08.916556 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.customers"
[0m11:38:08.917555 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customers (compile): 2023-04-05 11:38:08.914552 => 2023-04-05 11:38:08.917555
[0m11:38:08.917922 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.customers
[0m11:38:08.945774 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.customers"
[0m11:38:08.946777 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.customers"
[0m11:38:08.947776 [debug] [Thread-1 (]: On model.upgrade_skills.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.customers"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.customers
  
   as (
    SELECT 
    *
FROM raw.jaffle_shop.customers
  );
[0m11:38:08.947776 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:38:10.150028 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m11:38:10.165076 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customers (execute): 2023-04-05 11:38:08.917922 => 2023-04-05 11:38:10.165076
[0m11:38:10.165076 [debug] [Thread-1 (]: On model.upgrade_skills.customers: Close
[0m11:38:10.423105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97685d9b-843a-4a05-8f92-c7aeccc51c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226F987510>]}
[0m11:38:10.424109 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_PC_ATOS.customers ......................... [[32mSUCCESS 1[0m in 1.51s]
[0m11:38:10.425108 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.customers
[0m11:38:10.427125 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:38:10.428103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:10.428103 [debug] [MainThread]: Connection 'create_PC_DBT_DB_DBT_PC_ATOS' was properly closed.
[0m11:38:10.429111 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_PC_ATOS' was properly closed.
[0m11:38:10.429349 [debug] [MainThread]: Connection 'model.upgrade_skills.customers' was properly closed.
[0m11:38:10.429349 [info ] [MainThread]: 
[0m11:38:10.430408 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.25 seconds (6.25s).
[0m11:38:10.430990 [debug] [MainThread]: Command end result
[0m11:38:10.436499 [info ] [MainThread]: 
[0m11:38:10.437939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:10.438654 [info ] [MainThread]: 
[0m11:38:10.439283 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:38:10.440067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226EA04690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226FA22D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226F984350>]}
[0m11:38:10.440558 [debug] [MainThread]: Flushing usage events


============================== 2023-04-05 11:39:42.604749 | 660e384b-5114-49d9-9f88-48f02c9741a7 ==============================
[0m11:39:42.604749 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:39:42.605749 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:39:42.606747 [debug] [MainThread]: Tracking: tracking
[0m11:39:42.607019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4FEDEA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4EA37250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4FEE6A90>]}
[0m11:39:42.615059 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:39:42.685200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:39:42.685200 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:39:42.686788 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_snow.published
- models.dbt_snow.compute
- models.dbt_snow.staging
[0m11:39:42.692805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '660e384b-5114-49d9-9f88-48f02c9741a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4FA2DC10>]}
[0m11:39:42.698806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '660e384b-5114-49d9-9f88-48f02c9741a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4FF27950>]}
[0m11:39:42.699386 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 306 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:39:42.700139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '660e384b-5114-49d9-9f88-48f02c9741a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4F1DA8D0>]}
[0m11:39:42.701175 [info ] [MainThread]: 
[0m11:39:42.703088 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:39:42.704085 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m11:39:42.715104 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m11:39:42.716104 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m11:39:42.716104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:44.044712 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:39:44.046720 [debug] [ThreadPool]: On list_PC_DBT_DB: Close
[0m11:39:44.307295 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_PC_ATOS'
[0m11:39:44.320218 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_PC_ATOS"
[0m11:39:44.320218 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB_DBT_PC_ATOS"} */
show terse objects in PC_DBT_DB.DBT_PC_ATOS
[0m11:39:44.321220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:45.699835 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1 seconds
[0m11:39:45.701300 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS: Close
[0m11:39:45.964556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '660e384b-5114-49d9-9f88-48f02c9741a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4DA0FE50>]}
[0m11:39:45.965698 [info ] [MainThread]: Concurrency: 2 threads (target='snow')
[0m11:39:45.966212 [info ] [MainThread]: 
[0m11:39:45.971229 [debug] [Thread-1 (]: Began running node model.upgrade_skills.customer_orders_step_6-210923-113810
[0m11:39:45.971229 [debug] [Thread-2 (]: Began running node model.upgrade_skills.customers
[0m11:39:45.972231 [info ] [Thread-1 (]: 1 of 8 START sql view model DBT_PC_ATOS.customer_orders_step_6-210923-113810 ... [RUN]
[0m11:39:45.972231 [info ] [Thread-2 (]: 2 of 8 START sql view model DBT_PC_ATOS.customers .............................. [RUN]
[0m11:39:45.973367 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.customer_orders_step_6-210923-113810'
[0m11:39:45.973367 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.customers'
[0m11:39:45.974375 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.customer_orders_step_6-210923-113810
[0m11:39:45.974375 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.customers
[0m11:39:45.975374 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.customer_orders_step_6-210923-113810"
[0m11:39:45.978064 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.customers"
[0m11:39:45.980579 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.customers (compile): 2023-04-05 11:39:45.976527 => 2023-04-05 11:39:45.980579
[0m11:39:45.981081 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.customers
[0m11:39:45.981414 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customer_orders_step_6-210923-113810 (compile): 2023-04-05 11:39:45.974375 => 2023-04-05 11:39:45.981414
[0m11:39:46.005537 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.customers"
[0m11:39:46.005537 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.customer_orders_step_6-210923-113810
[0m11:39:46.008864 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.customer_orders_step_6-210923-113810"
[0m11:39:46.010097 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.customers"
[0m11:39:46.010473 [debug] [Thread-2 (]: On model.upgrade_skills.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.customers"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.customers
  
   as (
    SELECT 
    *
FROM raw.jaffle_shop.customers
  );
[0m11:39:46.011031 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:39:46.015039 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.customer_orders_step_6-210923-113810"
[0m11:39:46.017037 [debug] [Thread-1 (]: On model.upgrade_skills.customer_orders_step_6-210923-113810: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.customer_orders_step_6-210923-113810"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.customer_orders_step_6-210923-113810
  
   as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    last_name as surname,
    first_name as givenname,
    first_order_date,
    order_count,
    total_lifetime_value,
    round(amount/100.0,2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
from raw.jaffle_shop.orders as orders

join (
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
) customers
on orders.user_id = customers.id

join (

    select 
        b.id as customer_id,
        b.name as full_name,
        b.last_name as surname,
        b.first_name as givenname,
        min(order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then order_date end) as most_recent_non_returned_order_date,
        COALESCE(max(user_order_seq),0) as order_count,
        COALESCE(count(case when a.status != 'returned' then 1 end),0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end)/NULLIF(count(case when a.status NOT IN ('returned','return_pending') then 1 end),0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
      select 
        row_number() over (partition by user_id order by order_date, id) as user_order_seq,
        *
      from raw.jaffle_shop.orders
    ) a

    join ( 
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
    ) b
    on a.user_id = b.id

    left outer join raw.stripe.payment c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.name, b.last_name, b.first_name

) customer_order_history
on orders.user_id = customer_order_history.customer_id

left outer join raw.stripe.payment payments
on orders.id = payments.orderid

where payments.status != 'fail'
  );
[0m11:39:46.017549 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:39:47.355151 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1 seconds
[0m11:39:47.373774 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.customers (execute): 2023-04-05 11:39:45.981414 => 2023-04-05 11:39:47.373774
[0m11:39:47.373774 [debug] [Thread-2 (]: On model.upgrade_skills.customers: Close
[0m11:39:47.469138 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ab6c3b-3200-b450-0002-9afe0006f02e
[0m11:39:47.469138 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 69 unexpected '-'.
[0m11:39:47.470575 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customer_orders_step_6-210923-113810 (execute): 2023-04-05 11:39:46.006522 => 2023-04-05 11:39:47.470355
[0m11:39:47.470575 [debug] [Thread-1 (]: On model.upgrade_skills.customer_orders_step_6-210923-113810: Close
[0m11:39:47.671643 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '660e384b-5114-49d9-9f88-48f02c9741a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4E354E10>]}
[0m11:39:47.671643 [info ] [Thread-2 (]: 2 of 8 OK created sql view model DBT_PC_ATOS.customers ......................... [[32mSUCCESS 1[0m in 1.70s]
[0m11:39:47.675643 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.customers
[0m11:39:47.675643 [debug] [Thread-2 (]: Began running node model.upgrade_skills.stg_jaffle_shop__customers
[0m11:39:47.676645 [info ] [Thread-2 (]: 3 of 8 START sql view model DBT_PC_ATOS.stg_jaffle_shop__customers ............. [RUN]
[0m11:39:47.677649 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_jaffle_shop__customers'
[0m11:39:47.678403 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.stg_jaffle_shop__customers
[0m11:39:47.680685 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.stg_jaffle_shop__customers"
[0m11:39:47.681798 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__customers (compile): 2023-04-05 11:39:47.678403 => 2023-04-05 11:39:47.681798
[0m11:39:47.681798 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.stg_jaffle_shop__customers
[0m11:39:47.684905 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.stg_jaffle_shop__customers"
[0m11:39:47.686768 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.stg_jaffle_shop__customers"
[0m11:39:47.687269 [debug] [Thread-2 (]: On model.upgrade_skills.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.stg_jaffle_shop__customers"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__customers
  
   as (
    with

source as (

    select * from raw.jaffle_shop.customers

),

transformed as (

    select 

        id as customer_id,
        last_name as surname,
        first_name as givenname,
        first_name || ' ' || last_name as full_name

    from source

)

select * from transformed
  );
[0m11:39:47.687511 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:39:47.726967 [debug] [Thread-1 (]: Database Error in model customer_orders_step_6-210923-113810 (models\publish\customer_orders_step_6-210923-113810.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 69 unexpected '-'.
  compiled Code at target\run\upgrade_skills\models\publish\customer_orders_step_6-210923-113810.sql
[0m11:39:47.728021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '660e384b-5114-49d9-9f88-48f02c9741a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A50472BD0>]}
[0m11:39:47.728521 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model DBT_PC_ATOS.customer_orders_step_6-210923-113810  [[31mERROR[0m in 1.75s]
[0m11:39:47.729545 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.customer_orders_step_6-210923-113810
[0m11:39:47.729938 [debug] [Thread-1 (]: Began running node model.upgrade_skills.stg_jaffle_shop__orders
[0m11:39:47.729938 [info ] [Thread-1 (]: 4 of 8 START sql view model DBT_PC_ATOS.stg_jaffle_shop__orders ................ [RUN]
[0m11:39:47.731351 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_jaffle_shop__orders'
[0m11:39:47.732288 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.stg_jaffle_shop__orders
[0m11:39:47.734287 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.stg_jaffle_shop__orders"
[0m11:39:47.736386 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__orders (compile): 2023-04-05 11:39:47.732288 => 2023-04-05 11:39:47.736386
[0m11:39:47.736386 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.stg_jaffle_shop__orders
[0m11:39:47.739743 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.stg_jaffle_shop__orders"
[0m11:39:47.741637 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.stg_jaffle_shop__orders"
[0m11:39:47.742138 [debug] [Thread-1 (]: On model.upgrade_skills.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.stg_jaffle_shop__orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__orders
  
   as (
    with

source as (
    
    select * from raw.jaffle_shop.orders
    
),

transformed as (
        
      select 
      
        id as order_id,
        user_id as customer_id,
        status as order_status,
        order_date,
        
        case 
            when order_status not in ('returned','return_pending') 
            then order_date 
        end as valid_order_date,
        
        row_number() over (
            partition by user_id 
            order by order_date, id
        ) as user_order_seq
        
      from source
    
)

select * from transformed
  );
[0m11:39:47.742138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:48.929862 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1 seconds
[0m11:39:48.931377 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__customers (execute): 2023-04-05 11:39:47.682904 => 2023-04-05 11:39:48.931377
[0m11:39:48.932377 [debug] [Thread-2 (]: On model.upgrade_skills.stg_jaffle_shop__customers: Close
[0m11:39:49.012469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m11:39:49.016468 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__orders (execute): 2023-04-05 11:39:47.737223 => 2023-04-05 11:39:49.016468
[0m11:39:49.017467 [debug] [Thread-1 (]: On model.upgrade_skills.stg_jaffle_shop__orders: Close
[0m11:39:49.188192 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '660e384b-5114-49d9-9f88-48f02c9741a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4FFB81D0>]}
[0m11:39:49.189192 [info ] [Thread-2 (]: 3 of 8 OK created sql view model DBT_PC_ATOS.stg_jaffle_shop__customers ........ [[32mSUCCESS 1[0m in 1.51s]
[0m11:39:49.190192 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.stg_jaffle_shop__customers
[0m11:39:49.191194 [debug] [Thread-2 (]: Began running node model.upgrade_skills.stg_stripe__payments
[0m11:39:49.192467 [info ] [Thread-2 (]: 5 of 8 START sql view model DBT_PC_ATOS.stg_stripe__payments ................... [RUN]
[0m11:39:49.193344 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_stripe__payments'
[0m11:39:49.193344 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.stg_stripe__payments
[0m11:39:49.196720 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.stg_stripe__payments"
[0m11:39:49.198246 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_stripe__payments (compile): 2023-04-05 11:39:49.194355 => 2023-04-05 11:39:49.198246
[0m11:39:49.198933 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.stg_stripe__payments
[0m11:39:49.201251 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.stg_stripe__payments"
[0m11:39:49.203251 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.stg_stripe__payments"
[0m11:39:49.204252 [debug] [Thread-2 (]: On model.upgrade_skills.stg_stripe__payments: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.stg_stripe__payments"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.stg_stripe__payments
  
   as (
    with

source as (

    select * from raw.stripe.payments

),

transformed as (

    select 

        id as payment_id,
        orderid as order_id,
        status as payment_status,
        round(amount/100.2, 2) as payment_amount

    from source

)

select * from transformed
  );
[0m11:39:49.204252 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:39:49.271241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '660e384b-5114-49d9-9f88-48f02c9741a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A50544FD0>]}
[0m11:39:49.272100 [info ] [Thread-1 (]: 4 of 8 OK created sql view model DBT_PC_ATOS.stg_jaffle_shop__orders ........... [[32mSUCCESS 1[0m in 1.54s]
[0m11:39:49.273532 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.stg_jaffle_shop__orders
[0m11:39:50.165500 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ab6c3b-3200-b447-0002-9afe0007003e
[0m11:39:50.166000 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.STRIPE.PAYMENTS' does not exist or not authorized.
[0m11:39:50.166574 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_stripe__payments (execute): 2023-04-05 11:39:49.199231 => 2023-04-05 11:39:50.166574
[0m11:39:50.166999 [debug] [Thread-2 (]: On model.upgrade_skills.stg_stripe__payments: Close
[0m11:39:50.416027 [debug] [Thread-2 (]: Database Error in model stg_stripe__payments (models\staging\stg_stripe__payments.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.STRIPE.PAYMENTS' does not exist or not authorized.
  compiled Code at target\run\upgrade_skills\models\staging\stg_stripe__payments.sql
[0m11:39:50.416027 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '660e384b-5114-49d9-9f88-48f02c9741a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A508C4390>]}
[0m11:39:50.417032 [error] [Thread-2 (]: 5 of 8 ERROR creating sql view model DBT_PC_ATOS.stg_stripe__payments .......... [[31mERROR[0m in 1.22s]
[0m11:39:50.418003 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.stg_stripe__payments
[0m11:39:50.418503 [debug] [Thread-1 (]: Began running node model.upgrade_skills.int_orders
[0m11:39:50.419275 [info ] [Thread-1 (]: 6 of 8 SKIP relation DBT_PC_ATOS.int_orders .................................... [[33mSKIP[0m]
[0m11:39:50.419890 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.int_orders
[0m11:39:50.420890 [debug] [Thread-2 (]: Began running node model.upgrade_skills.fct_customer_orders-210923-112800
[0m11:39:50.420890 [debug] [Thread-1 (]: Began running node model.upgrade_skills.final_model
[0m11:39:50.421922 [info ] [Thread-2 (]: 7 of 8 SKIP relation DBT_PC_ATOS.fct_customer_orders-210923-112800 ............. [[33mSKIP[0m]
[0m11:39:50.422191 [info ] [Thread-1 (]: 8 of 8 SKIP relation DBT_PC_ATOS.final_model ................................... [[33mSKIP[0m]
[0m11:39:50.422957 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.fct_customer_orders-210923-112800
[0m11:39:50.423281 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.final_model
[0m11:39:50.425211 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:39:50.426002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:50.427374 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was properly closed.
[0m11:39:50.427738 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_PC_ATOS' was properly closed.
[0m11:39:50.428276 [debug] [MainThread]: Connection 'model.upgrade_skills.stg_jaffle_shop__orders' was properly closed.
[0m11:39:50.428276 [debug] [MainThread]: Connection 'model.upgrade_skills.stg_stripe__payments' was properly closed.
[0m11:39:50.429051 [info ] [MainThread]: 
[0m11:39:50.429715 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 7.73 seconds (7.73s).
[0m11:39:50.430365 [debug] [MainThread]: Command end result
[0m11:39:50.440250 [info ] [MainThread]: 
[0m11:39:50.441158 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:39:50.441797 [info ] [MainThread]: 
[0m11:39:50.442296 [error] [MainThread]: [33mDatabase Error in model customer_orders_step_6-210923-113810 (models\publish\customer_orders_step_6-210923-113810.sql)[0m
[0m11:39:50.443110 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m11:39:50.443683 [error] [MainThread]:   syntax error line 1 at position 69 unexpected '-'.
[0m11:39:50.444184 [error] [MainThread]:   compiled Code at target\run\upgrade_skills\models\publish\customer_orders_step_6-210923-113810.sql
[0m11:39:50.445188 [info ] [MainThread]: 
[0m11:39:50.445709 [error] [MainThread]: [33mDatabase Error in model stg_stripe__payments (models\staging\stg_stripe__payments.sql)[0m
[0m11:39:50.446211 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m11:39:50.447210 [error] [MainThread]:   Object 'RAW.STRIPE.PAYMENTS' does not exist or not authorized.
[0m11:39:50.447493 [error] [MainThread]:   compiled Code at target\run\upgrade_skills\models\staging\stg_stripe__payments.sql
[0m11:39:50.447992 [info ] [MainThread]: 
[0m11:39:50.448566 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=3 TOTAL=8
[0m11:39:50.448991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4F8159D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A500A41D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4E383AD0>]}
[0m11:39:50.448991 [debug] [MainThread]: Flushing usage events


============================== 2023-04-05 11:41:22.855266 | fb2ac8ad-aa85-4d07-a487-b492be30a779 ==============================
[0m11:41:22.855266 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:41:22.856766 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:41:22.857266 [debug] [MainThread]: Tracking: tracking
[0m11:41:22.857765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA51257D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA513F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA513E290>]}
[0m11:41:22.865350 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:41:22.924900 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m11:41:22.925952 [debug] [MainThread]: Partial parsing: added file: upgrade_skills://models\publish\fct_customer_orders.sql
[0m11:41:22.926712 [debug] [MainThread]: Partial parsing: added file: upgrade_skills://models\publish\customer_orders.sql
[0m11:41:22.927472 [debug] [MainThread]: Partial parsing: deleted file: upgrade_skills://models\publish\customer_orders_step_6-210923-113810.sql
[0m11:41:22.927758 [debug] [MainThread]: Partial parsing: deleted file: upgrade_skills://models\publish\fct_customer_orders-210923-112800.sql
[0m11:41:22.937792 [debug] [MainThread]: 1699: static parser successfully parsed publish\fct_customer_orders.sql
[0m11:41:22.950002 [debug] [MainThread]: 1699: static parser successfully parsed publish\customer_orders.sql
[0m11:41:22.958963 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_snow.published
- models.dbt_snow.compute
- models.dbt_snow.staging
[0m11:41:22.963193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb2ac8ad-aa85-4d07-a487-b492be30a779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA51AD310>]}
[0m11:41:22.970611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb2ac8ad-aa85-4d07-a487-b492be30a779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA5217790>]}
[0m11:41:22.970611 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 306 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:41:22.971581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb2ac8ad-aa85-4d07-a487-b492be30a779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA5217FD0>]}
[0m11:41:22.973598 [info ] [MainThread]: 
[0m11:41:22.975598 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:41:22.977618 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m11:41:22.987703 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m11:41:22.988711 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m11:41:22.988711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:24.396485 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:41:24.399657 [debug] [ThreadPool]: On list_PC_DBT_DB: Close
[0m11:41:24.709558 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_PC_ATOS'
[0m11:41:24.715556 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_PC_ATOS"
[0m11:41:24.715556 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB_DBT_PC_ATOS"} */
show terse objects in PC_DBT_DB.DBT_PC_ATOS
[0m11:41:24.716553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:25.930402 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1 seconds
[0m11:41:25.931403 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS: Close
[0m11:41:26.188782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb2ac8ad-aa85-4d07-a487-b492be30a779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA5629110>]}
[0m11:41:26.191796 [info ] [MainThread]: Concurrency: 2 threads (target='snow')
[0m11:41:26.192707 [info ] [MainThread]: 
[0m11:41:26.206572 [debug] [Thread-1 (]: Began running node model.upgrade_skills.customer_orders
[0m11:41:26.207764 [debug] [Thread-2 (]: Began running node model.upgrade_skills.customers
[0m11:41:26.208991 [info ] [Thread-1 (]: 1 of 8 START sql view model DBT_PC_ATOS.customer_orders ........................ [RUN]
[0m11:41:26.210642 [info ] [Thread-2 (]: 2 of 8 START sql view model DBT_PC_ATOS.customers .............................. [RUN]
[0m11:41:26.213194 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.customer_orders'
[0m11:41:26.214781 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.customers'
[0m11:41:26.216507 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.customer_orders
[0m11:41:26.217179 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.customers
[0m11:41:26.220527 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.customer_orders"
[0m11:41:26.225803 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.customers"
[0m11:41:26.229095 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customer_orders (compile): 2023-04-05 11:41:26.218504 => 2023-04-05 11:41:26.229095
[0m11:41:26.230096 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.customer_orders
[0m11:41:26.230593 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.customers (compile): 2023-04-05 11:41:26.222263 => 2023-04-05 11:41:26.230593
[0m11:41:26.274207 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.customer_orders"
[0m11:41:26.274207 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.customers
[0m11:41:26.280418 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.customers"
[0m11:41:26.283917 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.customer_orders"
[0m11:41:26.285198 [debug] [Thread-1 (]: On model.upgrade_skills.customer_orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.customer_orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.customer_orders
  
   as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    last_name as surname,
    first_name as givenname,
    first_order_date,
    order_count,
    total_lifetime_value,
    round(amount/100.0,2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
from raw.jaffle_shop.orders as orders

join (
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
) customers
on orders.user_id = customers.id

join (

    select 
        b.id as customer_id,
        b.name as full_name,
        b.last_name as surname,
        b.first_name as givenname,
        min(order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then order_date end) as most_recent_non_returned_order_date,
        COALESCE(max(user_order_seq),0) as order_count,
        COALESCE(count(case when a.status != 'returned' then 1 end),0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end)/NULLIF(count(case when a.status NOT IN ('returned','return_pending') then 1 end),0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
      select 
        row_number() over (partition by user_id order by order_date, id) as user_order_seq,
        *
      from raw.jaffle_shop.orders
    ) a

    join ( 
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
    ) b
    on a.user_id = b.id

    left outer join raw.stripe.payment c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.name, b.last_name, b.first_name

) customer_order_history
on orders.user_id = customer_order_history.customer_id

left outer join raw.stripe.payment payments
on orders.id = payments.orderid

where payments.status != 'fail'
  );
[0m11:41:26.285700 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:41:26.286698 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.customers"
[0m11:41:26.290213 [debug] [Thread-2 (]: On model.upgrade_skills.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.customers"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.customers
  
   as (
    SELECT 
    *
FROM raw.jaffle_shop.customers
  );
[0m11:41:26.291276 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:41:27.738155 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1 seconds
[0m11:41:27.756061 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.customers (execute): 2023-04-05 11:41:26.276151 => 2023-04-05 11:41:27.756061
[0m11:41:27.757058 [debug] [Thread-2 (]: On model.upgrade_skills.customers: Close
[0m11:41:27.861985 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m11:41:27.864974 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customer_orders (execute): 2023-04-05 11:41:26.231097 => 2023-04-05 11:41:27.864974
[0m11:41:27.865974 [debug] [Thread-1 (]: On model.upgrade_skills.customer_orders: Close
[0m11:41:28.012473 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb2ac8ad-aa85-4d07-a487-b492be30a779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA5693ED0>]}
[0m11:41:28.013473 [info ] [Thread-2 (]: 2 of 8 OK created sql view model DBT_PC_ATOS.customers ......................... [[32mSUCCESS 1[0m in 1.80s]
[0m11:41:28.014472 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.customers
[0m11:41:28.015473 [debug] [Thread-2 (]: Began running node model.upgrade_skills.stg_jaffle_shop__customers
[0m11:41:28.015473 [info ] [Thread-2 (]: 3 of 8 START sql view model DBT_PC_ATOS.stg_jaffle_shop__customers ............. [RUN]
[0m11:41:28.016535 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_jaffle_shop__customers'
[0m11:41:28.016535 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.stg_jaffle_shop__customers
[0m11:41:28.018312 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.stg_jaffle_shop__customers"
[0m11:41:28.019958 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__customers (compile): 2023-04-05 11:41:28.017281 => 2023-04-05 11:41:28.019958
[0m11:41:28.020720 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.stg_jaffle_shop__customers
[0m11:41:28.023235 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.stg_jaffle_shop__customers"
[0m11:41:28.024418 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.stg_jaffle_shop__customers"
[0m11:41:28.024418 [debug] [Thread-2 (]: On model.upgrade_skills.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.stg_jaffle_shop__customers"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__customers
  
   as (
    with

source as (

    select * from raw.jaffle_shop.customers

),

transformed as (

    select 

        id as customer_id,
        last_name as surname,
        first_name as givenname,
        first_name || ' ' || last_name as full_name

    from source

)

select * from transformed
  );
[0m11:41:28.025258 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:41:28.124703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb2ac8ad-aa85-4d07-a487-b492be30a779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA515AC90>]}
[0m11:41:28.125703 [info ] [Thread-1 (]: 1 of 8 OK created sql view model DBT_PC_ATOS.customer_orders ................... [[32mSUCCESS 1[0m in 1.91s]
[0m11:41:28.127104 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.customer_orders
[0m11:41:28.127586 [debug] [Thread-1 (]: Began running node model.upgrade_skills.stg_jaffle_shop__orders
[0m11:41:28.128142 [info ] [Thread-1 (]: 4 of 8 START sql view model DBT_PC_ATOS.stg_jaffle_shop__orders ................ [RUN]
[0m11:41:28.128846 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_jaffle_shop__orders'
[0m11:41:28.128846 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.stg_jaffle_shop__orders
[0m11:41:28.131882 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.stg_jaffle_shop__orders"
[0m11:41:28.132471 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__orders (compile): 2023-04-05 11:41:28.129841 => 2023-04-05 11:41:28.132471
[0m11:41:28.133760 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.stg_jaffle_shop__orders
[0m11:41:28.137276 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.stg_jaffle_shop__orders"
[0m11:41:28.139047 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.stg_jaffle_shop__orders"
[0m11:41:28.139047 [debug] [Thread-1 (]: On model.upgrade_skills.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.stg_jaffle_shop__orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__orders
  
   as (
    with

source as (
    
    select * from raw.jaffle_shop.orders
    
),

transformed as (
        
      select 
      
        id as order_id,
        user_id as customer_id,
        status as order_status,
        order_date,
        
        case 
            when order_status not in ('returned','return_pending') 
            then order_date 
        end as valid_order_date,
        
        row_number() over (
            partition by user_id 
            order by order_date, id
        ) as user_order_seq
        
      from source
    
)

select * from transformed
  );
[0m11:41:28.140283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:29.249542 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1 seconds
[0m11:41:29.251611 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__customers (execute): 2023-04-05 11:41:28.020720 => 2023-04-05 11:41:29.251611
[0m11:41:29.252556 [debug] [Thread-2 (]: On model.upgrade_skills.stg_jaffle_shop__customers: Close
[0m11:41:29.422125 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m11:41:29.426125 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__orders (execute): 2023-04-05 11:41:28.134259 => 2023-04-05 11:41:29.426125
[0m11:41:29.426125 [debug] [Thread-1 (]: On model.upgrade_skills.stg_jaffle_shop__orders: Close
[0m11:41:29.513424 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb2ac8ad-aa85-4d07-a487-b492be30a779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA5214510>]}
[0m11:41:29.513876 [info ] [Thread-2 (]: 3 of 8 OK created sql view model DBT_PC_ATOS.stg_jaffle_shop__customers ........ [[32mSUCCESS 1[0m in 1.50s]
[0m11:41:29.514935 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.stg_jaffle_shop__customers
[0m11:41:29.515590 [debug] [Thread-2 (]: Began running node model.upgrade_skills.stg_stripe__payments
[0m11:41:29.515923 [info ] [Thread-2 (]: 5 of 8 START sql view model DBT_PC_ATOS.stg_stripe__payments ................... [RUN]
[0m11:41:29.516990 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_stripe__payments'
[0m11:41:29.517426 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.stg_stripe__payments
[0m11:41:29.519923 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.stg_stripe__payments"
[0m11:41:29.521937 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_stripe__payments (compile): 2023-04-05 11:41:29.517945 => 2023-04-05 11:41:29.521426
[0m11:41:29.522425 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.stg_stripe__payments
[0m11:41:29.524450 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.stg_stripe__payments"
[0m11:41:29.526453 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.stg_stripe__payments"
[0m11:41:29.526453 [debug] [Thread-2 (]: On model.upgrade_skills.stg_stripe__payments: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.stg_stripe__payments"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.stg_stripe__payments
  
   as (
    with

source as (

    select * from raw.stripe.payments

),

transformed as (

    select 

        id as payment_id,
        orderid as order_id,
        status as payment_status,
        round(amount/100.2, 2) as payment_amount

    from source

)

select * from transformed
  );
[0m11:41:29.527482 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:41:29.741390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb2ac8ad-aa85-4d07-a487-b492be30a779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA567FBD0>]}
[0m11:41:29.742391 [info ] [Thread-1 (]: 4 of 8 OK created sql view model DBT_PC_ATOS.stg_jaffle_shop__orders ........... [[32mSUCCESS 1[0m in 1.61s]
[0m11:41:29.742391 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.stg_jaffle_shop__orders
[0m11:41:30.505242 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ab6c3d-3200-b41d-0002-9afe0006e0ea
[0m11:41:30.505242 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.STRIPE.PAYMENTS' does not exist or not authorized.
[0m11:41:30.506325 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_stripe__payments (execute): 2023-04-05 11:41:29.522925 => 2023-04-05 11:41:30.506325
[0m11:41:30.506824 [debug] [Thread-2 (]: On model.upgrade_skills.stg_stripe__payments: Close
[0m11:41:30.839934 [debug] [Thread-2 (]: Database Error in model stg_stripe__payments (models\staging\stg_stripe__payments.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.STRIPE.PAYMENTS' does not exist or not authorized.
  compiled Code at target\run\upgrade_skills\models\staging\stg_stripe__payments.sql
[0m11:41:30.840969 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb2ac8ad-aa85-4d07-a487-b492be30a779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA5214510>]}
[0m11:41:30.841469 [error] [Thread-2 (]: 5 of 8 ERROR creating sql view model DBT_PC_ATOS.stg_stripe__payments .......... [[31mERROR[0m in 1.32s]
[0m11:41:30.842383 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.stg_stripe__payments
[0m11:41:30.842884 [debug] [Thread-1 (]: Began running node model.upgrade_skills.int_orders
[0m11:41:30.844271 [info ] [Thread-1 (]: 6 of 8 SKIP relation DBT_PC_ATOS.int_orders .................................... [[33mSKIP[0m]
[0m11:41:30.845046 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.int_orders
[0m11:41:30.845587 [debug] [Thread-2 (]: Began running node model.upgrade_skills.fct_customer_orders
[0m11:41:30.846520 [debug] [Thread-1 (]: Began running node model.upgrade_skills.final_model
[0m11:41:30.846520 [info ] [Thread-2 (]: 7 of 8 SKIP relation DBT_PC_ATOS.fct_customer_orders ........................... [[33mSKIP[0m]
[0m11:41:30.847245 [info ] [Thread-1 (]: 8 of 8 SKIP relation DBT_PC_ATOS.final_model ................................... [[33mSKIP[0m]
[0m11:41:30.848246 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.fct_customer_orders
[0m11:41:30.848745 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.final_model
[0m11:41:30.851640 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:41:30.852912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:30.853475 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was properly closed.
[0m11:41:30.853982 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_PC_ATOS' was properly closed.
[0m11:41:30.854248 [debug] [MainThread]: Connection 'model.upgrade_skills.stg_jaffle_shop__orders' was properly closed.
[0m11:41:30.854690 [debug] [MainThread]: Connection 'model.upgrade_skills.stg_stripe__payments' was properly closed.
[0m11:41:30.855690 [info ] [MainThread]: 
[0m11:41:30.856520 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 7.88 seconds (7.88s).
[0m11:41:30.857124 [debug] [MainThread]: Command end result
[0m11:41:30.863436 [info ] [MainThread]: 
[0m11:41:30.864344 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:41:30.864845 [info ] [MainThread]: 
[0m11:41:30.865843 [error] [MainThread]: [33mDatabase Error in model stg_stripe__payments (models\staging\stg_stripe__payments.sql)[0m
[0m11:41:30.866451 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m11:41:30.866990 [error] [MainThread]:   Object 'RAW.STRIPE.PAYMENTS' does not exist or not authorized.
[0m11:41:30.867489 [error] [MainThread]:   compiled Code at target\run\upgrade_skills\models\staging\stg_stripe__payments.sql
[0m11:41:30.868187 [info ] [MainThread]: 
[0m11:41:30.868652 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=3 TOTAL=8
[0m11:41:30.869418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA3D09DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA5258050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EA4DB9150>]}
[0m11:41:30.869863 [debug] [MainThread]: Flushing usage events


============================== 2023-04-05 11:42:13.033032 | bf6da79e-9880-42bc-88d5-d59322013f03 ==============================
[0m11:42:13.033032 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:42:13.035029 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:42:13.035029 [debug] [MainThread]: Tracking: tracking
[0m11:42:13.035029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C2808590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C25F8ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C30FEED0>]}
[0m11:42:13.043867 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:42:13.109067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:42:13.110060 [debug] [MainThread]: Partial parsing: updated file: upgrade_skills://models\source\source.yml
[0m11:42:13.111044 [debug] [MainThread]: Partial parsing: updated file: upgrade_skills://models\staging\stg_stripe__payments.sql
[0m11:42:13.120320 [debug] [MainThread]: 1699: static parser successfully parsed publish\fct_customer_orders.sql
[0m11:42:13.132098 [debug] [MainThread]: 1699: static parser successfully parsed compute\final_model.sql
[0m11:42:13.135079 [debug] [MainThread]: 1699: static parser successfully parsed compute\int_orders.sql
[0m11:42:13.137208 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_stripe__payments.sql
[0m11:42:13.152685 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_snow.staging
- models.dbt_snow.compute
- models.dbt_snow.published
[0m11:42:13.160190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf6da79e-9880-42bc-88d5-d59322013f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C3CE7550>]}
[0m11:42:13.171381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf6da79e-9880-42bc-88d5-d59322013f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C3DA8650>]}
[0m11:42:13.172383 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 306 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:42:13.172383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf6da79e-9880-42bc-88d5-d59322013f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C21E9AD0>]}
[0m11:42:13.174673 [info ] [MainThread]: 
[0m11:42:13.177749 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:42:13.179664 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m11:42:13.191664 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m11:42:13.192664 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m11:42:13.192664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:14.471588 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m11:42:14.475589 [debug] [ThreadPool]: On list_PC_DBT_DB: Close
[0m11:42:14.748813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_PC_ATOS'
[0m11:42:14.756911 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_PC_ATOS"
[0m11:42:14.758084 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB_DBT_PC_ATOS"} */
show terse objects in PC_DBT_DB.DBT_PC_ATOS
[0m11:42:14.758084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:16.039561 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1 seconds
[0m11:42:16.042561 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS: Close
[0m11:42:16.378752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf6da79e-9880-42bc-88d5-d59322013f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C180FE50>]}
[0m11:42:16.379754 [info ] [MainThread]: Concurrency: 2 threads (target='snow')
[0m11:42:16.380751 [info ] [MainThread]: 
[0m11:42:16.387561 [debug] [Thread-1 (]: Began running node model.upgrade_skills.customer_orders
[0m11:42:16.388561 [debug] [Thread-2 (]: Began running node model.upgrade_skills.customers
[0m11:42:16.388561 [info ] [Thread-1 (]: 1 of 8 START sql view model DBT_PC_ATOS.customer_orders ........................ [RUN]
[0m11:42:16.390064 [info ] [Thread-2 (]: 2 of 8 START sql view model DBT_PC_ATOS.customers .............................. [RUN]
[0m11:42:16.390801 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.customer_orders'
[0m11:42:16.391930 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.customers'
[0m11:42:16.391930 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.customer_orders
[0m11:42:16.392972 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.customers
[0m11:42:16.394018 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.customer_orders"
[0m11:42:16.396016 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.customers"
[0m11:42:16.397437 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customer_orders (compile): 2023-04-05 11:42:16.392972 => 2023-04-05 11:42:16.397437
[0m11:42:16.397819 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.customers (compile): 2023-04-05 11:42:16.394018 => 2023-04-05 11:42:16.397819
[0m11:42:16.398398 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.customer_orders
[0m11:42:16.398398 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.customers
[0m11:42:16.421810 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.customer_orders"
[0m11:42:16.425211 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.customers"
[0m11:42:16.429322 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.customer_orders"
[0m11:42:16.429322 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.customers"
[0m11:42:16.430324 [debug] [Thread-1 (]: On model.upgrade_skills.customer_orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.customer_orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.customer_orders
  
   as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    last_name as surname,
    first_name as givenname,
    first_order_date,
    order_count,
    total_lifetime_value,
    round(amount/100.0,2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
from raw.jaffle_shop.orders as orders

join (
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
) customers
on orders.user_id = customers.id

join (

    select 
        b.id as customer_id,
        b.name as full_name,
        b.last_name as surname,
        b.first_name as givenname,
        min(order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then order_date end) as most_recent_non_returned_order_date,
        COALESCE(max(user_order_seq),0) as order_count,
        COALESCE(count(case when a.status != 'returned' then 1 end),0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end)/NULLIF(count(case when a.status NOT IN ('returned','return_pending') then 1 end),0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
      select 
        row_number() over (partition by user_id order by order_date, id) as user_order_seq,
        *
      from raw.jaffle_shop.orders
    ) a

    join ( 
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
    ) b
    on a.user_id = b.id

    left outer join raw.stripe.payment c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.name, b.last_name, b.first_name

) customer_order_history
on orders.user_id = customer_order_history.customer_id

left outer join raw.stripe.payment payments
on orders.id = payments.orderid

where payments.status != 'fail'
  );
[0m11:42:16.430324 [debug] [Thread-2 (]: On model.upgrade_skills.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.customers"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.customers
  
   as (
    SELECT 
    *
FROM raw.jaffle_shop.customers
  );
[0m11:42:16.431323 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:42:16.431323 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:42:17.773555 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m11:42:17.791554 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customer_orders (execute): 2023-04-05 11:42:16.399173 => 2023-04-05 11:42:17.791554
[0m11:42:17.792555 [debug] [Thread-1 (]: On model.upgrade_skills.customer_orders: Close
[0m11:42:17.846699 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1 seconds
[0m11:42:17.848702 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.customers (execute): 2023-04-05 11:42:16.422184 => 2023-04-05 11:42:17.848702
[0m11:42:17.848702 [debug] [Thread-2 (]: On model.upgrade_skills.customers: Close
[0m11:42:18.044930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf6da79e-9880-42bc-88d5-d59322013f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C3CE7B10>]}
[0m11:42:18.046091 [info ] [Thread-1 (]: 1 of 8 OK created sql view model DBT_PC_ATOS.customer_orders ................... [[32mSUCCESS 1[0m in 1.65s]
[0m11:42:18.048301 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.customer_orders
[0m11:42:18.049566 [debug] [Thread-1 (]: Began running node model.upgrade_skills.stg_jaffle_shop__customers
[0m11:42:18.049566 [info ] [Thread-1 (]: 3 of 8 START sql view model DBT_PC_ATOS.stg_jaffle_shop__customers ............. [RUN]
[0m11:42:18.051191 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_jaffle_shop__customers'
[0m11:42:18.051191 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.stg_jaffle_shop__customers
[0m11:42:18.054167 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.stg_jaffle_shop__customers"
[0m11:42:18.055444 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__customers (compile): 2023-04-05 11:42:18.051191 => 2023-04-05 11:42:18.055444
[0m11:42:18.055911 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.stg_jaffle_shop__customers
[0m11:42:18.059111 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.stg_jaffle_shop__customers"
[0m11:42:18.060686 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.stg_jaffle_shop__customers"
[0m11:42:18.060686 [debug] [Thread-1 (]: On model.upgrade_skills.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.stg_jaffle_shop__customers"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__customers
  
   as (
    with

source as (

    select * from raw.jaffle_shop.customers

),

transformed as (

    select 

        id as customer_id,
        last_name as surname,
        first_name as givenname,
        first_name || ' ' || last_name as full_name

    from source

)

select * from transformed
  );
[0m11:42:18.061704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:18.096516 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf6da79e-9880-42bc-88d5-d59322013f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C3CB97D0>]}
[0m11:42:18.097270 [info ] [Thread-2 (]: 2 of 8 OK created sql view model DBT_PC_ATOS.customers ......................... [[32mSUCCESS 1[0m in 1.70s]
[0m11:42:18.097957 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.customers
[0m11:42:18.098438 [debug] [Thread-2 (]: Began running node model.upgrade_skills.stg_jaffle_shop__orders
[0m11:42:18.098940 [info ] [Thread-2 (]: 4 of 8 START sql view model DBT_PC_ATOS.stg_jaffle_shop__orders ................ [RUN]
[0m11:42:18.100475 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_jaffle_shop__orders'
[0m11:42:18.100855 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.stg_jaffle_shop__orders
[0m11:42:18.104175 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.stg_jaffle_shop__orders"
[0m11:42:18.105582 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__orders (compile): 2023-04-05 11:42:18.101181 => 2023-04-05 11:42:18.105582
[0m11:42:18.106098 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.stg_jaffle_shop__orders
[0m11:42:18.108608 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.stg_jaffle_shop__orders"
[0m11:42:18.110562 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.stg_jaffle_shop__orders"
[0m11:42:18.110562 [debug] [Thread-2 (]: On model.upgrade_skills.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.stg_jaffle_shop__orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__orders
  
   as (
    with

source as (
    
    select * from raw.jaffle_shop.orders
    
),

transformed as (
        
      select 
      
        id as order_id,
        user_id as customer_id,
        status as order_status,
        order_date,
        
        case 
            when order_status not in ('returned','return_pending') 
            then order_date 
        end as valid_order_date,
        
        row_number() over (
            partition by user_id 
            order by order_date, id
        ) as user_order_seq
        
      from source
    
)

select * from transformed
  );
[0m11:42:18.111729 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:42:19.388975 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m11:42:19.391981 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__customers (execute): 2023-04-05 11:42:18.056498 => 2023-04-05 11:42:19.391981
[0m11:42:19.391981 [debug] [Thread-1 (]: On model.upgrade_skills.stg_jaffle_shop__customers: Close
[0m11:42:19.683077 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2 seconds
[0m11:42:19.688797 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__orders (execute): 2023-04-05 11:42:18.106586 => 2023-04-05 11:42:19.688797
[0m11:42:19.690270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf6da79e-9880-42bc-88d5-d59322013f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C3E052D0>]}
[0m11:42:19.690896 [debug] [Thread-2 (]: On model.upgrade_skills.stg_jaffle_shop__orders: Close
[0m11:42:19.691771 [info ] [Thread-1 (]: 3 of 8 OK created sql view model DBT_PC_ATOS.stg_jaffle_shop__customers ........ [[32mSUCCESS 1[0m in 1.64s]
[0m11:42:19.695383 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.stg_jaffle_shop__customers
[0m11:42:19.696929 [debug] [Thread-1 (]: Began running node model.upgrade_skills.stg_stripe__payments
[0m11:42:19.697771 [info ] [Thread-1 (]: 5 of 8 START sql view model DBT_PC_ATOS.stg_stripe__payments ................... [RUN]
[0m11:42:19.699271 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_stripe__payments'
[0m11:42:19.699822 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.stg_stripe__payments
[0m11:42:19.703719 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.stg_stripe__payments"
[0m11:42:19.705807 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.stg_stripe__payments (compile): 2023-04-05 11:42:19.700772 => 2023-04-05 11:42:19.705807
[0m11:42:19.706333 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.stg_stripe__payments
[0m11:42:19.710066 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.stg_stripe__payments"
[0m11:42:19.711975 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.stg_stripe__payments"
[0m11:42:19.712527 [debug] [Thread-1 (]: On model.upgrade_skills.stg_stripe__payments: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.stg_stripe__payments"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.stg_stripe__payments
  
   as (
    with

source as (

    select * from raw.stripe.payment

),

transformed as (

    select 

        id as payment_id,
        orderid as order_id,
        status as payment_status,
        round(amount/100.2, 2) as payment_amount

    from source

)

select * from transformed
  );
[0m11:42:19.712827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:19.954752 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf6da79e-9880-42bc-88d5-d59322013f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C43F1C10>]}
[0m11:42:19.956516 [info ] [Thread-2 (]: 4 of 8 OK created sql view model DBT_PC_ATOS.stg_jaffle_shop__orders ........... [[32mSUCCESS 1[0m in 1.85s]
[0m11:42:19.957190 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.stg_jaffle_shop__orders
[0m11:42:20.978443 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m11:42:20.981440 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.stg_stripe__payments (execute): 2023-04-05 11:42:19.706837 => 2023-04-05 11:42:20.981440
[0m11:42:20.981440 [debug] [Thread-1 (]: On model.upgrade_skills.stg_stripe__payments: Close
[0m11:42:21.240173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf6da79e-9880-42bc-88d5-d59322013f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C4348890>]}
[0m11:42:21.240173 [info ] [Thread-1 (]: 5 of 8 OK created sql view model DBT_PC_ATOS.stg_stripe__payments .............. [[32mSUCCESS 1[0m in 1.54s]
[0m11:42:21.241494 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.stg_stripe__payments
[0m11:42:21.241965 [debug] [Thread-2 (]: Began running node model.upgrade_skills.int_orders
[0m11:42:21.242964 [info ] [Thread-2 (]: 6 of 8 START sql view model DBT_PC_ATOS.int_orders ............................. [RUN]
[0m11:42:21.243491 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.int_orders'
[0m11:42:21.243491 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.int_orders
[0m11:42:21.246516 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.int_orders"
[0m11:42:21.248003 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.int_orders (compile): 2023-04-05 11:42:21.244465 => 2023-04-05 11:42:21.248003
[0m11:42:21.248506 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.int_orders
[0m11:42:21.250844 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.int_orders"
[0m11:42:21.253535 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.int_orders"
[0m11:42:21.254385 [debug] [Thread-2 (]: On model.upgrade_skills.int_orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.int_orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.int_orders
  
   as (
    with

orders as (

    select * from PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__orders

),

payments as (

    select * from PC_DBT_DB.DBT_PC_ATOS.stg_stripe__payments
    where payment_status != 'fail'

),

order_totals as (

    select

        order_id,
        payment_status,
        sum(payment_amount_usd) as order_value_dollars

    from payments
    group by 1, 2

),

joined as (

    select

        orders.*,
        order_totals.payment_status,
        order_totals.order_value_dollars

    from orders 
    left join order_totals
        on orders.order_id = order_totals.order_id

)

select * from joined
  );
[0m11:42:21.254885 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:42:22.523439 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ab6c3e-3200-b441-0002-9afe0006d0da
[0m11:42:22.524364 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 25 at position 12
invalid identifier 'PAYMENT_AMOUNT_USD'
[0m11:42:22.524364 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.int_orders (execute): 2023-04-05 11:42:21.249009 => 2023-04-05 11:42:22.524364
[0m11:42:22.525404 [debug] [Thread-2 (]: On model.upgrade_skills.int_orders: Close
[0m11:42:22.787041 [debug] [Thread-2 (]: Database Error in model int_orders (models\compute\int_orders.sql)
  000904 (42000): SQL compilation error: error line 25 at position 12
  invalid identifier 'PAYMENT_AMOUNT_USD'
  compiled Code at target\run\upgrade_skills\models\compute\int_orders.sql
[0m11:42:22.788040 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf6da79e-9880-42bc-88d5-d59322013f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C3E63050>]}
[0m11:42:22.788369 [error] [Thread-2 (]: 6 of 8 ERROR creating sql view model DBT_PC_ATOS.int_orders .................... [[31mERROR[0m in 1.54s]
[0m11:42:22.789247 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.int_orders
[0m11:42:22.790500 [debug] [Thread-1 (]: Began running node model.upgrade_skills.fct_customer_orders
[0m11:42:22.790500 [debug] [Thread-2 (]: Began running node model.upgrade_skills.final_model
[0m11:42:22.790500 [info ] [Thread-1 (]: 7 of 8 SKIP relation DBT_PC_ATOS.fct_customer_orders ........................... [[33mSKIP[0m]
[0m11:42:22.791882 [info ] [Thread-2 (]: 8 of 8 SKIP relation DBT_PC_ATOS.final_model ................................... [[33mSKIP[0m]
[0m11:42:22.792277 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.fct_customer_orders
[0m11:42:22.792781 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.final_model
[0m11:42:22.795038 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:42:22.795679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:22.795679 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was properly closed.
[0m11:42:22.795679 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_PC_ATOS' was properly closed.
[0m11:42:22.796686 [debug] [MainThread]: Connection 'model.upgrade_skills.stg_stripe__payments' was properly closed.
[0m11:42:22.796686 [debug] [MainThread]: Connection 'model.upgrade_skills.int_orders' was properly closed.
[0m11:42:22.797389 [info ] [MainThread]: 
[0m11:42:22.798045 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 9.62 seconds (9.62s).
[0m11:42:22.798959 [debug] [MainThread]: Command end result
[0m11:42:22.806802 [info ] [MainThread]: 
[0m11:42:22.806802 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:42:22.807788 [info ] [MainThread]: 
[0m11:42:22.808288 [error] [MainThread]: [33mDatabase Error in model int_orders (models\compute\int_orders.sql)[0m
[0m11:42:22.808927 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 25 at position 12
[0m11:42:22.809582 [error] [MainThread]:   invalid identifier 'PAYMENT_AMOUNT_USD'
[0m11:42:22.810059 [error] [MainThread]:   compiled Code at target\run\upgrade_skills\models\compute\int_orders.sql
[0m11:42:22.810483 [info ] [MainThread]: 
[0m11:42:22.810935 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=2 TOTAL=8
[0m11:42:22.810935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C2EFA390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C215CF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C2F25490>]}
[0m11:42:22.811769 [debug] [MainThread]: Flushing usage events


============================== 2023-04-05 11:44:26.587903 | 715f9671-9515-4444-acac-ee2da2daf865 ==============================
[0m11:44:26.587903 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:44:26.588902 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:44:26.589905 [debug] [MainThread]: Tracking: tracking
[0m11:44:26.589905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BCDBA23D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BCDBB0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BCDBB1750>]}
[0m11:44:26.598697 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:44:27.643945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:44:27.644950 [debug] [MainThread]: Partial parsing: updated file: upgrade_skills://models\compute\int_orders.sql
[0m11:44:27.657643 [debug] [MainThread]: 1699: static parser successfully parsed compute\int_orders.sql
[0m11:44:27.674191 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_snow.staging
- models.dbt_snow.compute
- models.dbt_snow.published
[0m11:44:27.680027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '715f9671-9515-4444-acac-ee2da2daf865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BCDC27C50>]}
[0m11:44:27.686029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '715f9671-9515-4444-acac-ee2da2daf865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BCDC75A50>]}
[0m11:44:27.687026 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 306 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:44:27.688065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '715f9671-9515-4444-acac-ee2da2daf865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BCC6F86D0>]}
[0m11:44:27.689313 [info ] [MainThread]: 
[0m11:44:27.690160 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:44:27.692259 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m11:44:27.703917 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m11:44:27.703917 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m11:44:27.704918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:29.844589 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2 seconds
[0m11:44:29.846524 [debug] [ThreadPool]: On list_PC_DBT_DB: Close
[0m11:44:30.118836 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_PC_ATOS'
[0m11:44:30.128863 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_PC_ATOS"
[0m11:44:30.128863 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB_DBT_PC_ATOS"} */
show terse objects in PC_DBT_DB.DBT_PC_ATOS
[0m11:44:30.129867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:31.284901 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1 seconds
[0m11:44:31.286900 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS: Close
[0m11:44:31.546877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '715f9671-9515-4444-acac-ee2da2daf865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BCB70F790>]}
[0m11:44:31.548798 [info ] [MainThread]: Concurrency: 2 threads (target='snow')
[0m11:44:31.549317 [info ] [MainThread]: 
[0m11:44:31.591126 [debug] [Thread-1 (]: Began running node model.upgrade_skills.customer_orders
[0m11:44:31.591626 [debug] [Thread-2 (]: Began running node model.upgrade_skills.customers
[0m11:44:31.592038 [info ] [Thread-1 (]: 1 of 8 START sql view model DBT_PC_ATOS.customer_orders ........................ [RUN]
[0m11:44:31.593143 [info ] [Thread-2 (]: 2 of 8 START sql view model DBT_PC_ATOS.customers .............................. [RUN]
[0m11:44:31.594125 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.customer_orders'
[0m11:44:31.594624 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.customers'
[0m11:44:31.594624 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.customer_orders
[0m11:44:31.595679 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.customers
[0m11:44:31.597244 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.customer_orders"
[0m11:44:31.599240 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.customers"
[0m11:44:31.600599 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customer_orders (compile): 2023-04-05 11:44:31.596218 => 2023-04-05 11:44:31.600599
[0m11:44:31.601134 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.customers (compile): 2023-04-05 11:44:31.597244 => 2023-04-05 11:44:31.600599
[0m11:44:31.601134 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.customer_orders
[0m11:44:31.601636 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.customers
[0m11:44:31.625548 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.customer_orders"
[0m11:44:31.628547 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.customers"
[0m11:44:31.632430 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.customer_orders"
[0m11:44:31.633431 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.customers"
[0m11:44:31.633431 [debug] [Thread-1 (]: On model.upgrade_skills.customer_orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.customer_orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.customer_orders
  
   as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    last_name as surname,
    first_name as givenname,
    first_order_date,
    order_count,
    total_lifetime_value,
    round(amount/100.0,2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
from raw.jaffle_shop.orders as orders

join (
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
) customers
on orders.user_id = customers.id

join (

    select 
        b.id as customer_id,
        b.name as full_name,
        b.last_name as surname,
        b.first_name as givenname,
        min(order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then order_date end) as most_recent_non_returned_order_date,
        COALESCE(max(user_order_seq),0) as order_count,
        COALESCE(count(case when a.status != 'returned' then 1 end),0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end)/NULLIF(count(case when a.status NOT IN ('returned','return_pending') then 1 end),0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
      select 
        row_number() over (partition by user_id order by order_date, id) as user_order_seq,
        *
      from raw.jaffle_shop.orders
    ) a

    join ( 
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
    ) b
    on a.user_id = b.id

    left outer join raw.stripe.payment c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.name, b.last_name, b.first_name

) customer_order_history
on orders.user_id = customer_order_history.customer_id

left outer join raw.stripe.payment payments
on orders.id = payments.orderid

where payments.status != 'fail'
  );
[0m11:44:31.634427 [debug] [Thread-2 (]: On model.upgrade_skills.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.customers"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.customers
  
   as (
    SELECT 
    *
FROM raw.jaffle_shop.customers
  );
[0m11:44:31.634427 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:44:31.634427 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:44:33.233342 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2 seconds
[0m11:44:33.249061 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.customers (execute): 2023-04-05 11:44:31.626545 => 2023-04-05 11:44:33.249061
[0m11:44:33.249061 [debug] [Thread-2 (]: On model.upgrade_skills.customers: Close
[0m11:44:33.268505 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m11:44:33.271615 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customer_orders (execute): 2023-04-05 11:44:31.602249 => 2023-04-05 11:44:33.271615
[0m11:44:33.271615 [debug] [Thread-1 (]: On model.upgrade_skills.customer_orders: Close
[0m11:44:33.497264 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '715f9671-9515-4444-acac-ee2da2daf865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BCDCDA1D0>]}
[0m11:44:33.498346 [info ] [Thread-2 (]: 2 of 8 OK created sql view model DBT_PC_ATOS.customers ......................... [[32mSUCCESS 1[0m in 1.90s]
[0m11:44:33.502409 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.customers
[0m11:44:33.502409 [debug] [Thread-2 (]: Began running node model.upgrade_skills.stg_jaffle_shop__customers
[0m11:44:33.503659 [info ] [Thread-2 (]: 3 of 8 START sql view model DBT_PC_ATOS.stg_jaffle_shop__customers ............. [RUN]
[0m11:44:33.504679 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_jaffle_shop__customers'
[0m11:44:33.505672 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.stg_jaffle_shop__customers
[0m11:44:33.509689 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.stg_jaffle_shop__customers"
[0m11:44:33.511669 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__customers (compile): 2023-04-05 11:44:33.505672 => 2023-04-05 11:44:33.511669
[0m11:44:33.511669 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.stg_jaffle_shop__customers
[0m11:44:33.514592 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.stg_jaffle_shop__customers"
[0m11:44:33.517668 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.stg_jaffle_shop__customers"
[0m11:44:33.518772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '715f9671-9515-4444-acac-ee2da2daf865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BCDD3C110>]}
[0m11:44:33.519666 [debug] [Thread-2 (]: On model.upgrade_skills.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.stg_jaffle_shop__customers"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__customers
  
   as (
    with

source as (

    select * from raw.jaffle_shop.customers

),

transformed as (

    select 

        id as customer_id,
        last_name as surname,
        first_name as givenname,
        first_name || ' ' || last_name as full_name

    from source

)

select * from transformed
  );
[0m11:44:33.520667 [info ] [Thread-1 (]: 1 of 8 OK created sql view model DBT_PC_ATOS.customer_orders ................... [[32mSUCCESS 1[0m in 1.93s]
[0m11:44:33.520667 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:44:33.521676 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.customer_orders
[0m11:44:33.524703 [debug] [Thread-1 (]: Began running node model.upgrade_skills.stg_jaffle_shop__orders
[0m11:44:33.525733 [info ] [Thread-1 (]: 4 of 8 START sql view model DBT_PC_ATOS.stg_jaffle_shop__orders ................ [RUN]
[0m11:44:33.526748 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_jaffle_shop__orders'
[0m11:44:33.526748 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.stg_jaffle_shop__orders
[0m11:44:33.528797 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.stg_jaffle_shop__orders"
[0m11:44:33.530222 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__orders (compile): 2023-04-05 11:44:33.526748 => 2023-04-05 11:44:33.530222
[0m11:44:33.530222 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.stg_jaffle_shop__orders
[0m11:44:33.534229 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.stg_jaffle_shop__orders"
[0m11:44:33.535247 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.stg_jaffle_shop__orders"
[0m11:44:33.536229 [debug] [Thread-1 (]: On model.upgrade_skills.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.stg_jaffle_shop__orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__orders
  
   as (
    with

source as (
    
    select * from raw.jaffle_shop.orders
    
),

transformed as (
        
      select 
      
        id as order_id,
        user_id as customer_id,
        status as order_status,
        order_date,
        
        case 
            when order_status not in ('returned','return_pending') 
            then order_date 
        end as valid_order_date,
        
        row_number() over (
            partition by user_id 
            order by order_date, id
        ) as user_order_seq
        
      from source
    
)

select * from transformed
  );
[0m11:44:33.536229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:34.791155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m11:44:34.795891 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__orders (execute): 2023-04-05 11:44:33.530222 => 2023-04-05 11:44:34.795891
[0m11:44:34.795891 [debug] [Thread-1 (]: On model.upgrade_skills.stg_jaffle_shop__orders: Close
[0m11:44:35.069853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '715f9671-9515-4444-acac-ee2da2daf865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BCD7A06D0>]}
[0m11:44:35.071814 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2 seconds
[0m11:44:35.072911 [info ] [Thread-1 (]: 4 of 8 OK created sql view model DBT_PC_ATOS.stg_jaffle_shop__orders ........... [[32mSUCCESS 1[0m in 1.54s]
[0m11:44:35.075822 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__customers (execute): 2023-04-05 11:44:33.512578 => 2023-04-05 11:44:35.075822
[0m11:44:35.076820 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.stg_jaffle_shop__orders
[0m11:44:35.077529 [debug] [Thread-2 (]: On model.upgrade_skills.stg_jaffle_shop__customers: Close
[0m11:44:35.078593 [debug] [Thread-1 (]: Began running node model.upgrade_skills.stg_stripe__payments
[0m11:44:35.079600 [info ] [Thread-1 (]: 5 of 8 START sql view model DBT_PC_ATOS.stg_stripe__payments ................... [RUN]
[0m11:44:35.081140 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_stripe__payments'
[0m11:44:35.082435 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.stg_stripe__payments
[0m11:44:35.084663 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.stg_stripe__payments"
[0m11:44:35.086611 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.stg_stripe__payments (compile): 2023-04-05 11:44:35.082435 => 2023-04-05 11:44:35.086611
[0m11:44:35.086611 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.stg_stripe__payments
[0m11:44:35.090061 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.stg_stripe__payments"
[0m11:44:35.093048 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.stg_stripe__payments"
[0m11:44:35.093048 [debug] [Thread-1 (]: On model.upgrade_skills.stg_stripe__payments: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.stg_stripe__payments"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.stg_stripe__payments
  
   as (
    with

source as (

    select * from raw.stripe.payment

),

transformed as (

    select 

        id as payment_id,
        orderid as order_id,
        status as payment_status,
        round(amount/100.2, 2) as payment_amount

    from source

)

select * from transformed
  );
[0m11:44:35.093646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:35.335202 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '715f9671-9515-4444-acac-ee2da2daf865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BCC734C10>]}
[0m11:44:35.336917 [info ] [Thread-2 (]: 3 of 8 OK created sql view model DBT_PC_ATOS.stg_jaffle_shop__customers ........ [[32mSUCCESS 1[0m in 1.83s]
[0m11:44:35.337783 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.stg_jaffle_shop__customers
[0m11:44:36.254515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m11:44:36.260510 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.stg_stripe__payments (execute): 2023-04-05 11:44:35.087620 => 2023-04-05 11:44:36.260510
[0m11:44:36.261514 [debug] [Thread-1 (]: On model.upgrade_skills.stg_stripe__payments: Close
[0m11:44:36.543030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '715f9671-9515-4444-acac-ee2da2daf865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BCDD22E10>]}
[0m11:44:36.544142 [info ] [Thread-1 (]: 5 of 8 OK created sql view model DBT_PC_ATOS.stg_stripe__payments .............. [[32mSUCCESS 1[0m in 1.46s]
[0m11:44:36.544584 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.stg_stripe__payments
[0m11:44:36.545537 [debug] [Thread-2 (]: Began running node model.upgrade_skills.int_orders
[0m11:44:36.546538 [info ] [Thread-2 (]: 6 of 8 START sql view model DBT_PC_ATOS.int_orders ............................. [RUN]
[0m11:44:36.548039 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.int_orders'
[0m11:44:36.548539 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.int_orders
[0m11:44:36.551564 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.int_orders"
[0m11:44:36.552954 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.int_orders (compile): 2023-04-05 11:44:36.549039 => 2023-04-05 11:44:36.552954
[0m11:44:36.553563 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.int_orders
[0m11:44:36.556313 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.int_orders"
[0m11:44:36.558366 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.int_orders"
[0m11:44:36.558366 [debug] [Thread-2 (]: On model.upgrade_skills.int_orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.int_orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.int_orders
  
   as (
    with

orders as (

    select * from PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__orders

),

payments as (

    select * from PC_DBT_DB.DBT_PC_ATOS.stg_stripe__payments
    where payment_status != 'fail'

),

order_totals as (

    select

        order_id,
        payment_status,
        sum(payment_amount) as order_value_dollars

    from payments
    group by 1, 2

),

joined as (

    select

        orders.*,
        order_totals.payment_status,
        order_totals.order_value_dollars

    from orders 
    left join order_totals
        on orders.order_id = order_totals.order_id

)

select * from joined
  );
[0m11:44:36.559839 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:44:37.802746 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1 seconds
[0m11:44:37.804900 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.int_orders (execute): 2023-04-05 11:44:36.554297 => 2023-04-05 11:44:37.804900
[0m11:44:37.805894 [debug] [Thread-2 (]: On model.upgrade_skills.int_orders: Close
[0m11:44:38.049808 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '715f9671-9515-4444-acac-ee2da2daf865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BCE290B90>]}
[0m11:44:38.051901 [info ] [Thread-2 (]: 6 of 8 OK created sql view model DBT_PC_ATOS.int_orders ........................ [[32mSUCCESS 1[0m in 1.50s]
[0m11:44:38.052815 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.int_orders
[0m11:44:38.053701 [debug] [Thread-1 (]: Began running node model.upgrade_skills.fct_customer_orders
[0m11:44:38.054733 [debug] [Thread-2 (]: Began running node model.upgrade_skills.final_model
[0m11:44:38.055736 [info ] [Thread-1 (]: 7 of 8 START sql view model DBT_PC_ATOS.fct_customer_orders .................... [RUN]
[0m11:44:38.056681 [info ] [Thread-2 (]: 8 of 8 START sql view model DBT_PC_ATOS.final_model ............................ [RUN]
[0m11:44:38.058227 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.fct_customer_orders'
[0m11:44:38.059204 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.final_model'
[0m11:44:38.060204 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.fct_customer_orders
[0m11:44:38.060204 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.final_model
[0m11:44:38.062308 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.fct_customer_orders"
[0m11:44:38.065192 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.final_model"
[0m11:44:38.066954 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.final_model (compile): 2023-04-05 11:44:38.063295 => 2023-04-05 11:44:38.066954
[0m11:44:38.066954 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.final_model
[0m11:44:38.069894 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.final_model"
[0m11:44:38.070894 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.fct_customer_orders (compile): 2023-04-05 11:44:38.061207 => 2023-04-05 11:44:38.070894
[0m11:44:38.071998 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.fct_customer_orders
[0m11:44:38.073988 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.final_model"
[0m11:44:38.076074 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.fct_customer_orders"
[0m11:44:38.077097 [debug] [Thread-2 (]: On model.upgrade_skills.final_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.final_model"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.final_model
  
   as (
    with 

orders as (

  select * from PC_DBT_DB.DBT_PC_ATOS.int_orders

),

customers as (

  select * from PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__customers

),

customer_orders as (

  select 

    orders.*,
    customers.full_name,
    customers.surname,
    customers.givenname,

    --- Customer level aggregations
    min(orders.order_date) over(
      partition by orders.customer_id
    ) as customer_first_order_date,

    min(orders.valid_order_date) over(
      partition by orders.customer_id
    ) as customer_first_non_returned_order_date,

    max(orders.valid_order_date) over(
      partition by orders.customer_id
    ) as customer_most_recent_non_returned_order_date,

    count(*) over(
      partition by orders.customer_id
    ) as customer_order_count,

    sum(nvl2(orders.valid_order_date, 1, 0)) over(
      partition by orders.customer_id
    ) as customer_non_returned_order_count,

    sum(nvl2(orders.valid_order_date, orders.order_value_dollars, 0)) over(
      partition by orders.customer_id
    ) as customer_total_lifetime_value,

    array_agg(distinct orders.order_id) over(
      partition by orders.customer_id
    ) as customer_order_ids

  from orders
  inner join customers
    on orders.customer_id = customers.customer_id

),

add_avg_order_values as (

  select

    *,

    customer_total_lifetime_value / customer_non_returned_order_count 
    as customer_avg_non_returned_order_value

  from customer_orders

),

final as (

  select 

    order_id,
    customer_id,
    surname,
    givenname,
    customer_first_order_date as first_order_date,
    customer_order_count as order_count,
    customer_total_lifetime_value as total_lifetime_value,
    order_value_dollars,
    order_status,
    payment_status

  from add_avg_order_values

)

select * from final
  );
[0m11:44:38.077994 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:44:38.081344 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.fct_customer_orders"
[0m11:44:38.082250 [debug] [Thread-1 (]: On model.upgrade_skills.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.fct_customer_orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.fct_customer_orders
  
   as (
    with

customers as (

    select * from PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__customers

),

orders as (

    select * from PC_DBT_DB.DBT_PC_ATOS.int_orders

),

final as (

    select

        orders.*,

        customers.surname,
        customers.givenname,

        -- Customer-level aggregations
        min(orders.order_date) over(
            partition by orders.customer_id
        ) as first_order_date,

        min(orders.valid_order_date) over(
            partition by orders.customer_id
        ) as first_non_returned_order_date,

        max(orders.valid_order_date) over(
            partition by orders.customer_id
        ) as most_recent_non_returned_order_date,

        count(*) over(
            partition by orders.customer_id
        ) as order_count,

        sum(nvl2(orders.valid_order_date, 1, 0)) over(
            partition by orders.customer_id
        ) as non_returned_order_count,

        array_agg(distinct orders.order_id) over(
            partition by orders.customer_id
        ) as order_ids,

        sum(nvl2(orders.valid_order_date, orders.order_value_dollars, 0)) over(
            partition by orders.customer_id
        ) as total_lifetime_value

    from orders
    inner join customers
        on orders.customer_id = customers.customer_id

)

select * from final
  );
[0m11:44:38.082250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:39.551946 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1 seconds
[0m11:44:39.555992 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.final_model (execute): 2023-04-05 11:44:38.067843 => 2023-04-05 11:44:39.555992
[0m11:44:39.556994 [debug] [Thread-2 (]: On model.upgrade_skills.final_model: Close
[0m11:44:39.565141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m11:44:39.566984 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.fct_customer_orders (execute): 2023-04-05 11:44:38.073988 => 2023-04-05 11:44:39.566984
[0m11:44:39.566984 [debug] [Thread-1 (]: On model.upgrade_skills.fct_customer_orders: Close
[0m11:44:39.849867 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '715f9671-9515-4444-acac-ee2da2daf865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BCDCD37D0>]}
[0m11:44:39.850887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '715f9671-9515-4444-acac-ee2da2daf865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BCDCB1E10>]}
[0m11:44:39.852481 [info ] [Thread-2 (]: 8 of 8 OK created sql view model DBT_PC_ATOS.final_model ....................... [[32mSUCCESS 1[0m in 1.79s]
[0m11:44:39.853611 [info ] [Thread-1 (]: 7 of 8 OK created sql view model DBT_PC_ATOS.fct_customer_orders ............... [[32mSUCCESS 1[0m in 1.79s]
[0m11:44:39.854610 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.final_model
[0m11:44:39.855316 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.fct_customer_orders
[0m11:44:39.857415 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:44:39.858934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:44:39.859683 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was properly closed.
[0m11:44:39.860195 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_PC_ATOS' was properly closed.
[0m11:44:39.860195 [debug] [MainThread]: Connection 'model.upgrade_skills.fct_customer_orders' was properly closed.
[0m11:44:39.860696 [debug] [MainThread]: Connection 'model.upgrade_skills.final_model' was properly closed.
[0m11:44:39.861195 [info ] [MainThread]: 
[0m11:44:39.862149 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 12.17 seconds (12.17s).
[0m11:44:39.862763 [debug] [MainThread]: Command end result
[0m11:44:39.871810 [info ] [MainThread]: 
[0m11:44:39.872730 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:44:39.873229 [info ] [MainThread]: 
[0m11:44:39.873735 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m11:44:39.874820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BCE08C590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BCCBF9E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BCCBF9790>]}
[0m11:44:39.875320 [debug] [MainThread]: Flushing usage events


============================== 2023-04-05 12:02:06.237275 | 0a7a9015-e494-48f2-aaaa-642b79f20e8d ==============================
[0m12:02:06.237275 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:02:06.240370 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:02:06.241365 [debug] [MainThread]: Tracking: tracking
[0m12:02:06.244289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DAFEBAE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DAE25FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DAFEF1490>]}
[0m12:02:06.276623 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:02:07.332559 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:02:07.332559 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:02:07.333560 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_snow.compute
- models.dbt_snow.staging
- models.dbt_snow.published
[0m12:02:07.345320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a7a9015-e494-48f2-aaaa-642b79f20e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DAFAAA590>]}
[0m12:02:07.352004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a7a9015-e494-48f2-aaaa-642b79f20e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DAFF27A90>]}
[0m12:02:07.352288 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 306 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:02:07.353239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a7a9015-e494-48f2-aaaa-642b79f20e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DAFF12CD0>]}
[0m12:02:07.354737 [info ] [MainThread]: 
[0m12:02:07.356776 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:02:07.358775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m12:02:07.376721 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m12:02:07.377653 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m12:02:07.378159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:09.568477 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2 seconds
[0m12:02:09.574106 [debug] [ThreadPool]: On list_PC_DBT_DB: Close
[0m12:02:09.854775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_PC_ATOS'
[0m12:02:09.880771 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_PC_ATOS"
[0m12:02:09.882501 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB_DBT_PC_ATOS"} */
show terse objects in PC_DBT_DB.DBT_PC_ATOS
[0m12:02:09.884007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:11.282209 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:02:11.284725 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS: Close
[0m12:02:11.544249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a7a9015-e494-48f2-aaaa-642b79f20e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB00A7F10>]}
[0m12:02:11.545248 [info ] [MainThread]: Concurrency: 2 threads (target='snow')
[0m12:02:11.546249 [info ] [MainThread]: 
[0m12:02:11.599081 [debug] [Thread-1 (]: Began running node model.upgrade_skills.customer_orders
[0m12:02:11.600094 [debug] [Thread-2 (]: Began running node model.upgrade_skills.customers
[0m12:02:11.600094 [info ] [Thread-1 (]: 1 of 8 START sql view model DBT_PC_ATOS.customer_orders ........................ [RUN]
[0m12:02:11.601513 [info ] [Thread-2 (]: 2 of 8 START sql view model DBT_PC_ATOS.customers .............................. [RUN]
[0m12:02:11.602542 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.customer_orders'
[0m12:02:11.604544 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.customers'
[0m12:02:11.604544 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.customer_orders
[0m12:02:11.605547 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.customers
[0m12:02:11.608488 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.customer_orders"
[0m12:02:11.611888 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.customers"
[0m12:02:11.614742 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customer_orders (compile): 2023-04-05 12:02:11.606259 => 2023-04-05 12:02:11.614341
[0m12:02:11.615243 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.customers (compile): 2023-04-05 12:02:11.608488 => 2023-04-05 12:02:11.615243
[0m12:02:11.615243 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.customer_orders
[0m12:02:11.616141 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.customers
[0m12:02:11.644958 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.customer_orders"
[0m12:02:11.647959 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.customers"
[0m12:02:11.650480 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.customers"
[0m12:02:11.653685 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.customer_orders"
[0m12:02:11.654686 [debug] [Thread-2 (]: On model.upgrade_skills.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.customers"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.customers
  
   as (
    SELECT 
    *
FROM raw.jaffle_shop.customers
  );
[0m12:02:11.655220 [debug] [Thread-1 (]: On model.upgrade_skills.customer_orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.customer_orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.customer_orders
  
   as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    last_name as surname,
    first_name as givenname,
    first_order_date,
    order_count,
    total_lifetime_value,
    round(amount/100.0,2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
from raw.jaffle_shop.orders as orders

join (
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
) customers
on orders.user_id = customers.id

join (

    select 
        b.id as customer_id,
        b.name as full_name,
        b.last_name as surname,
        b.first_name as givenname,
        min(order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then order_date end) as most_recent_non_returned_order_date,
        COALESCE(max(user_order_seq),0) as order_count,
        COALESCE(count(case when a.status != 'returned' then 1 end),0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end)/NULLIF(count(case when a.status NOT IN ('returned','return_pending') then 1 end),0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
      select 
        row_number() over (partition by user_id order by order_date, id) as user_order_seq,
        *
      from raw.jaffle_shop.orders
    ) a

    join ( 
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
    ) b
    on a.user_id = b.id

    left outer join raw.stripe.payment c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.name, b.last_name, b.first_name

) customer_order_history
on orders.user_id = customer_order_history.customer_id

left outer join raw.stripe.payment payments
on orders.id = payments.orderid

where payments.status != 'fail'
  );
[0m12:02:11.655381 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:02:11.656021 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:02:13.265571 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m12:02:13.294127 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customer_orders (execute): 2023-04-05 12:02:11.616497 => 2023-04-05 12:02:13.294127
[0m12:02:13.295608 [debug] [Thread-1 (]: On model.upgrade_skills.customer_orders: Close
[0m12:02:13.375526 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2 seconds
[0m12:02:13.378875 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.customers (execute): 2023-04-05 12:02:11.644958 => 2023-04-05 12:02:13.378875
[0m12:02:13.379955 [debug] [Thread-2 (]: On model.upgrade_skills.customers: Close
[0m12:02:13.549751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7a9015-e494-48f2-aaaa-642b79f20e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DAFEBBFD0>]}
[0m12:02:13.550751 [info ] [Thread-1 (]: 1 of 8 OK created sql view model DBT_PC_ATOS.customer_orders ................... [[32mSUCCESS 1[0m in 1.95s]
[0m12:02:13.552766 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.customer_orders
[0m12:02:13.552766 [debug] [Thread-1 (]: Began running node model.upgrade_skills.stg_jaffle_shop__customers
[0m12:02:13.553750 [info ] [Thread-1 (]: 3 of 8 START sql view model DBT_PC_ATOS.stg_jaffle_shop__customers ............. [RUN]
[0m12:02:13.554442 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_jaffle_shop__customers'
[0m12:02:13.554881 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.stg_jaffle_shop__customers
[0m12:02:13.557404 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.stg_jaffle_shop__customers"
[0m12:02:13.558404 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__customers (compile): 2023-04-05 12:02:13.555383 => 2023-04-05 12:02:13.558404
[0m12:02:13.558853 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.stg_jaffle_shop__customers
[0m12:02:13.562636 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.stg_jaffle_shop__customers"
[0m12:02:13.563942 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.stg_jaffle_shop__customers"
[0m12:02:13.563942 [debug] [Thread-1 (]: On model.upgrade_skills.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.stg_jaffle_shop__customers"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__customers
  
   as (
    with

source as (

    select * from raw.jaffle_shop.customers

),

transformed as (

    select 

        id as customer_id,
        last_name as surname,
        first_name as givenname,
        first_name || ' ' || last_name as full_name

    from source

)

select * from transformed
  );
[0m12:02:13.565368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:13.632026 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7a9015-e494-48f2-aaaa-642b79f20e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DAFF61090>]}
[0m12:02:13.635023 [info ] [Thread-2 (]: 2 of 8 OK created sql view model DBT_PC_ATOS.customers ......................... [[32mSUCCESS 1[0m in 2.03s]
[0m12:02:13.636163 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.customers
[0m12:02:13.636761 [debug] [Thread-2 (]: Began running node model.upgrade_skills.stg_jaffle_shop__orders
[0m12:02:13.637418 [info ] [Thread-2 (]: 4 of 8 START sql view model DBT_PC_ATOS.stg_jaffle_shop__orders ................ [RUN]
[0m12:02:13.638920 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_jaffle_shop__orders'
[0m12:02:13.639676 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.stg_jaffle_shop__orders
[0m12:02:13.645288 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.stg_jaffle_shop__orders"
[0m12:02:13.648271 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__orders (compile): 2023-04-05 12:02:13.640176 => 2023-04-05 12:02:13.648271
[0m12:02:13.649271 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.stg_jaffle_shop__orders
[0m12:02:13.656944 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.stg_jaffle_shop__orders"
[0m12:02:13.660778 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.stg_jaffle_shop__orders"
[0m12:02:13.661790 [debug] [Thread-2 (]: On model.upgrade_skills.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.stg_jaffle_shop__orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__orders
  
   as (
    with

source as (
    
    select * from raw.jaffle_shop.orders
    
),

transformed as (
        
      select 
      
        id as order_id,
        user_id as customer_id,
        status as order_status,
        order_date,
        
        case 
            when order_status not in ('returned','return_pending') 
            then order_date 
        end as valid_order_date,
        
        row_number() over (
            partition by user_id 
            order by order_date, id
        ) as user_order_seq
        
      from source
    
)

select * from transformed
  );
[0m12:02:13.662642 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:02:14.989210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m12:02:14.991794 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__customers (execute): 2023-04-05 12:02:13.559478 => 2023-04-05 12:02:14.991794
[0m12:02:14.992822 [debug] [Thread-1 (]: On model.upgrade_skills.stg_jaffle_shop__customers: Close
[0m12:02:15.000250 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1 seconds
[0m12:02:15.004696 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__orders (execute): 2023-04-05 12:02:13.650270 => 2023-04-05 12:02:15.004696
[0m12:02:15.005820 [debug] [Thread-2 (]: On model.upgrade_skills.stg_jaffle_shop__orders: Close
[0m12:02:15.446653 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7a9015-e494-48f2-aaaa-642b79f20e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB0194A90>]}
[0m12:02:15.449217 [info ] [Thread-2 (]: 4 of 8 OK created sql view model DBT_PC_ATOS.stg_jaffle_shop__orders ........... [[32mSUCCESS 1[0m in 1.81s]
[0m12:02:15.450794 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.stg_jaffle_shop__orders
[0m12:02:15.451794 [debug] [Thread-2 (]: Began running node model.upgrade_skills.stg_stripe__payments
[0m12:02:15.452795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7a9015-e494-48f2-aaaa-642b79f20e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB0159FD0>]}
[0m12:02:15.453564 [info ] [Thread-2 (]: 5 of 8 START sql view model DBT_PC_ATOS.stg_stripe__payments ................... [RUN]
[0m12:02:15.454585 [info ] [Thread-1 (]: 3 of 8 OK created sql view model DBT_PC_ATOS.stg_jaffle_shop__customers ........ [[32mSUCCESS 1[0m in 1.90s]
[0m12:02:15.456021 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_stripe__payments'
[0m12:02:15.457593 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.stg_jaffle_shop__customers
[0m12:02:15.458091 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.stg_stripe__payments
[0m12:02:15.462481 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.stg_stripe__payments"
[0m12:02:15.463744 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_stripe__payments (compile): 2023-04-05 12:02:15.458931 => 2023-04-05 12:02:15.463744
[0m12:02:15.464683 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.stg_stripe__payments
[0m12:02:15.468896 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.stg_stripe__payments"
[0m12:02:15.470550 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.stg_stripe__payments"
[0m12:02:15.472096 [debug] [Thread-2 (]: On model.upgrade_skills.stg_stripe__payments: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.stg_stripe__payments"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.stg_stripe__payments
  
   as (
    with

source as (

    select * from raw.stripe.payment

),

transformed as (

    select 

        id as payment_id,
        orderid as order_id,
        status as payment_status,
        round(amount/100.2, 2) as payment_amount

    from source

)

select * from transformed
  );
[0m12:02:15.472554 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:02:17.049791 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2 seconds
[0m12:02:17.056998 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_stripe__payments (execute): 2023-04-05 12:02:15.464683 => 2023-04-05 12:02:17.056998
[0m12:02:17.057988 [debug] [Thread-2 (]: On model.upgrade_skills.stg_stripe__payments: Close
[0m12:02:17.314815 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7a9015-e494-48f2-aaaa-642b79f20e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB01952D0>]}
[0m12:02:17.315815 [info ] [Thread-2 (]: 5 of 8 OK created sql view model DBT_PC_ATOS.stg_stripe__payments .............. [[32mSUCCESS 1[0m in 1.86s]
[0m12:02:17.316815 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.stg_stripe__payments
[0m12:02:17.317815 [debug] [Thread-1 (]: Began running node model.upgrade_skills.int_orders
[0m12:02:17.319560 [info ] [Thread-1 (]: 6 of 8 START sql view model DBT_PC_ATOS.int_orders ............................. [RUN]
[0m12:02:17.321377 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.int_orders'
[0m12:02:17.321955 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.int_orders
[0m12:02:17.327072 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.int_orders"
[0m12:02:17.330080 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.int_orders (compile): 2023-04-05 12:02:17.321955 => 2023-04-05 12:02:17.330080
[0m12:02:17.331724 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.int_orders
[0m12:02:17.337530 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.int_orders"
[0m12:02:17.341492 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.int_orders"
[0m12:02:17.342514 [debug] [Thread-1 (]: On model.upgrade_skills.int_orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.int_orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.int_orders
  
   as (
    with

orders as (

    select * from PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__orders

),

payments as (

    select * from PC_DBT_DB.DBT_PC_ATOS.stg_stripe__payments
    where payment_status != 'fail'

),

order_totals as (

    select

        order_id,
        payment_status,
        sum(payment_amount) as order_value_dollars

    from payments
    group by 1, 2

),

joined as (

    select

        orders.*,
        order_totals.payment_status,
        order_totals.order_value_dollars

    from orders 
    left join order_totals
        on orders.order_id = order_totals.order_id

)

select * from joined
  );
[0m12:02:17.343507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:18.567101 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m12:02:18.569864 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.int_orders (execute): 2023-04-05 12:02:17.332318 => 2023-04-05 12:02:18.569864
[0m12:02:18.570865 [debug] [Thread-1 (]: On model.upgrade_skills.int_orders: Close
[0m12:02:18.825787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7a9015-e494-48f2-aaaa-642b79f20e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB0507B10>]}
[0m12:02:18.827684 [info ] [Thread-1 (]: 6 of 8 OK created sql view model DBT_PC_ATOS.int_orders ........................ [[32mSUCCESS 1[0m in 1.50s]
[0m12:02:18.828635 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.int_orders
[0m12:02:18.830280 [debug] [Thread-2 (]: Began running node model.upgrade_skills.fct_customer_orders
[0m12:02:18.830780 [debug] [Thread-1 (]: Began running node model.upgrade_skills.final_model
[0m12:02:18.831281 [info ] [Thread-2 (]: 7 of 8 START sql view model DBT_PC_ATOS.fct_customer_orders .................... [RUN]
[0m12:02:18.832761 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.fct_customer_orders'
[0m12:02:18.832260 [info ] [Thread-1 (]: 8 of 8 START sql view model DBT_PC_ATOS.final_model ............................ [RUN]
[0m12:02:18.833760 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.fct_customer_orders
[0m12:02:18.834761 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.final_model'
[0m12:02:18.839032 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.fct_customer_orders"
[0m12:02:18.840049 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.final_model
[0m12:02:18.844654 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.final_model"
[0m12:02:18.845693 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.fct_customer_orders (compile): 2023-04-05 12:02:18.835778 => 2023-04-05 12:02:18.845693
[0m12:02:18.846243 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.fct_customer_orders
[0m12:02:18.847244 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.final_model (compile): 2023-04-05 12:02:18.841365 => 2023-04-05 12:02:18.846745
[0m12:02:18.851438 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.fct_customer_orders"
[0m12:02:18.852436 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.final_model
[0m12:02:18.857334 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.final_model"
[0m12:02:18.859835 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.fct_customer_orders"
[0m12:02:18.863906 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.final_model"
[0m12:02:18.864491 [debug] [Thread-2 (]: On model.upgrade_skills.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.fct_customer_orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.fct_customer_orders
  
   as (
    with

customers as (

    select * from PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__customers

),

orders as (

    select * from PC_DBT_DB.DBT_PC_ATOS.int_orders

),

final as (

    select

        orders.*,

        customers.surname,
        customers.givenname,

        -- Customer-level aggregations
        min(orders.order_date) over(
            partition by orders.customer_id
        ) as first_order_date,

        min(orders.valid_order_date) over(
            partition by orders.customer_id
        ) as first_non_returned_order_date,

        max(orders.valid_order_date) over(
            partition by orders.customer_id
        ) as most_recent_non_returned_order_date,

        count(*) over(
            partition by orders.customer_id
        ) as order_count,

        sum(nvl2(orders.valid_order_date, 1, 0)) over(
            partition by orders.customer_id
        ) as non_returned_order_count,

        array_agg(distinct orders.order_id) over(
            partition by orders.customer_id
        ) as order_ids,

        sum(nvl2(orders.valid_order_date, orders.order_value_dollars, 0)) over(
            partition by orders.customer_id
        ) as total_lifetime_value

    from orders
    inner join customers
        on orders.customer_id = customers.customer_id

)

select * from final
  );
[0m12:02:18.865150 [debug] [Thread-1 (]: On model.upgrade_skills.final_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.final_model"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.final_model
  
   as (
    with 

orders as (

  select * from PC_DBT_DB.DBT_PC_ATOS.int_orders

),

customers as (

  select * from PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__customers

),

customer_orders as (

  select 

    orders.*,
    customers.full_name,
    customers.surname,
    customers.givenname,

    --- Customer level aggregations
    min(orders.order_date) over(
      partition by orders.customer_id
    ) as customer_first_order_date,

    min(orders.valid_order_date) over(
      partition by orders.customer_id
    ) as customer_first_non_returned_order_date,

    max(orders.valid_order_date) over(
      partition by orders.customer_id
    ) as customer_most_recent_non_returned_order_date,

    count(*) over(
      partition by orders.customer_id
    ) as customer_order_count,

    sum(nvl2(orders.valid_order_date, 1, 0)) over(
      partition by orders.customer_id
    ) as customer_non_returned_order_count,

    sum(nvl2(orders.valid_order_date, orders.order_value_dollars, 0)) over(
      partition by orders.customer_id
    ) as customer_total_lifetime_value,

    array_agg(distinct orders.order_id) over(
      partition by orders.customer_id
    ) as customer_order_ids

  from orders
  inner join customers
    on orders.customer_id = customers.customer_id

),

add_avg_order_values as (

  select

    *,

    customer_total_lifetime_value / customer_non_returned_order_count 
    as customer_avg_non_returned_order_value

  from customer_orders

),

final as (

  select 

    order_id,
    customer_id,
    surname,
    givenname,
    customer_first_order_date as first_order_date,
    customer_order_count as order_count,
    customer_total_lifetime_value as total_lifetime_value,
    order_value_dollars,
    order_status,
    payment_status

  from add_avg_order_values

)

select * from final
  );
[0m12:02:18.867379 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:02:18.867880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:20.387835 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2 seconds
[0m12:02:20.389853 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.fct_customer_orders (execute): 2023-04-05 12:02:18.847333 => 2023-04-05 12:02:20.389853
[0m12:02:20.390840 [debug] [Thread-2 (]: On model.upgrade_skills.fct_customer_orders: Close
[0m12:02:20.470378 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m12:02:20.472394 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.final_model (execute): 2023-04-05 12:02:18.853437 => 2023-04-05 12:02:20.472394
[0m12:02:20.473394 [debug] [Thread-1 (]: On model.upgrade_skills.final_model: Close
[0m12:02:20.647246 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7a9015-e494-48f2-aaaa-642b79f20e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB0446850>]}
[0m12:02:20.648246 [info ] [Thread-2 (]: 7 of 8 OK created sql view model DBT_PC_ATOS.fct_customer_orders ............... [[32mSUCCESS 1[0m in 1.81s]
[0m12:02:20.649900 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.fct_customer_orders
[0m12:02:20.721141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7a9015-e494-48f2-aaaa-642b79f20e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DAFF24D50>]}
[0m12:02:20.722140 [info ] [Thread-1 (]: 8 of 8 OK created sql view model DBT_PC_ATOS.final_model ....................... [[32mSUCCESS 1[0m in 1.89s]
[0m12:02:20.723695 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.final_model
[0m12:02:20.726197 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:02:20.727694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:20.728579 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was properly closed.
[0m12:02:20.729077 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_PC_ATOS' was properly closed.
[0m12:02:20.729576 [debug] [MainThread]: Connection 'model.upgrade_skills.final_model' was properly closed.
[0m12:02:20.730122 [debug] [MainThread]: Connection 'model.upgrade_skills.fct_customer_orders' was properly closed.
[0m12:02:20.730621 [info ] [MainThread]: 
[0m12:02:20.731126 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 13.37 seconds (13.37s).
[0m12:02:20.732641 [debug] [MainThread]: Command end result
[0m12:02:20.744549 [info ] [MainThread]: 
[0m12:02:20.745093 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:02:20.746193 [info ] [MainThread]: 
[0m12:02:20.746896 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m12:02:20.747722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB014B6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB053BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB053BD90>]}
[0m12:02:20.748221 [debug] [MainThread]: Flushing usage events


============================== 2023-04-05 12:18:29.348583 | 9db4cc14-5b56-49d0-84a4-c6cc5f9240c9 ==============================
[0m12:18:29.348583 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:18:29.352560 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:18:29.353449 [debug] [MainThread]: Tracking: tracking
[0m12:18:29.354643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D02FA2910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D02FA0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D02F77310>]}
[0m12:18:29.389665 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:18:29.418279 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:18:29.419206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9db4cc14-5b56-49d0-84a4-c6cc5f9240c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D030C2A50>]}
[0m12:18:31.634973 [debug] [MainThread]: 1699: static parser successfully parsed compute\final_model.sql
[0m12:18:31.659216 [debug] [MainThread]: 1699: static parser successfully parsed compute\int_orders.sql
[0m12:18:31.666872 [debug] [MainThread]: 1699: static parser successfully parsed publish\customer_orders.sql
[0m12:18:31.670991 [debug] [MainThread]: 1699: static parser successfully parsed publish\fct_customer_orders.sql
[0m12:18:31.675973 [debug] [MainThread]: 1699: static parser successfully parsed staging\customers.sql
[0m12:18:31.679991 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__customers.sql
[0m12:18:31.688219 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__orders.sql
[0m12:18:31.696152 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_stripe__payments.sql
[0m12:18:31.772774 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_snow.staging
- models.dbt_snow.compute
- models.dbt_snow.published
[0m12:18:31.778869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9db4cc14-5b56-49d0-84a4-c6cc5f9240c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D0308B990>]}
[0m12:18:31.790681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9db4cc14-5b56-49d0-84a4-c6cc5f9240c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D031651D0>]}
[0m12:18:31.791682 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 306 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:18:31.792403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9db4cc14-5b56-49d0-84a4-c6cc5f9240c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D02F76F50>]}
[0m12:18:31.793891 [info ] [MainThread]: 
[0m12:18:31.795988 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:18:31.798751 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m12:18:31.813269 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m12:18:31.814800 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m12:18:31.815709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:34.263689 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2 seconds
[0m12:18:34.267445 [debug] [ThreadPool]: On list_PC_DBT_DB: Close
[0m12:18:34.521398 [debug] [ThreadPool]: Acquiring new snowflake connection 'create_PC_DBT_DB_DBT_PC_ATOS'
[0m12:18:34.522324 [debug] [ThreadPool]: Acquiring new snowflake connection 'create_PC_DBT_DB_DBT_PC_ATOS'
[0m12:18:34.524405 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='pc_dbt_db', schema='dbt_pc_atos', identifier=None)"
[0m12:18:34.538329 [debug] [ThreadPool]: Using snowflake connection "create_PC_DBT_DB_DBT_PC_ATOS"
[0m12:18:34.540376 [debug] [ThreadPool]: On create_PC_DBT_DB_DBT_PC_ATOS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "create_PC_DBT_DB_DBT_PC_ATOS"} */
create schema if not exists PC_DBT_DB.DBT_PC_ATOS
[0m12:18:34.541440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:35.780411 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1 seconds
[0m12:18:35.782994 [debug] [ThreadPool]: On create_PC_DBT_DB_DBT_PC_ATOS: Close
[0m12:18:36.063353 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_PC_ATOS'
[0m12:18:36.074798 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_PC_ATOS"
[0m12:18:36.075885 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB_DBT_PC_ATOS"} */
show terse objects in PC_DBT_DB.DBT_PC_ATOS
[0m12:18:36.076889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:37.344034 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1 seconds
[0m12:18:37.346034 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS: Close
[0m12:18:37.599416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9db4cc14-5b56-49d0-84a4-c6cc5f9240c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D02F5E2D0>]}
[0m12:18:37.600918 [info ] [MainThread]: Concurrency: 2 threads (target='snow')
[0m12:18:37.601985 [info ] [MainThread]: 
[0m12:18:37.653120 [debug] [Thread-1 (]: Began running node model.upgrade_skills.customer_orders
[0m12:18:37.653120 [debug] [Thread-2 (]: Began running node model.upgrade_skills.customers
[0m12:18:37.653120 [info ] [Thread-1 (]: 1 of 8 START sql view model DBT_PC_ATOS.customer_orders ........................ [RUN]
[0m12:18:37.655080 [info ] [Thread-2 (]: 2 of 8 START sql view model DBT_PC_ATOS.customers .............................. [RUN]
[0m12:18:37.657609 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.customer_orders'
[0m12:18:37.658533 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.customers'
[0m12:18:37.659298 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.customer_orders
[0m12:18:37.659796 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.customers
[0m12:18:37.661660 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.customer_orders"
[0m12:18:37.665630 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.customers"
[0m12:18:37.667456 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.customers (compile): 2023-04-05 12:18:37.662234 => 2023-04-05 12:18:37.667456
[0m12:18:37.667957 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customer_orders (compile): 2023-04-05 12:18:37.660501 => 2023-04-05 12:18:37.667957
[0m12:18:37.668716 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.customers
[0m12:18:37.668977 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.customer_orders
[0m12:18:37.707413 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.customers"
[0m12:18:37.712755 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.customer_orders"
[0m12:18:37.717343 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.customers"
[0m12:18:37.717913 [debug] [Thread-2 (]: On model.upgrade_skills.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.customers"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.customers
  
   as (
    SELECT 
    *
FROM raw.jaffle_shop.customers
  );
[0m12:18:37.722106 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.customer_orders"
[0m12:18:37.723103 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:18:37.724104 [debug] [Thread-1 (]: On model.upgrade_skills.customer_orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.customer_orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.customer_orders
  
   as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    last_name as surname,
    first_name as givenname,
    first_order_date,
    order_count,
    total_lifetime_value,
    round(amount/100.0,2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
from raw.jaffle_shop.orders as orders

join (
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
) customers
on orders.user_id = customers.id

join (

    select 
        b.id as customer_id,
        b.name as full_name,
        b.last_name as surname,
        b.first_name as givenname,
        min(order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then order_date end) as most_recent_non_returned_order_date,
        COALESCE(max(user_order_seq),0) as order_count,
        COALESCE(count(case when a.status != 'returned' then 1 end),0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end)/NULLIF(count(case when a.status NOT IN ('returned','return_pending') then 1 end),0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
      select 
        row_number() over (partition by user_id order by order_date, id) as user_order_seq,
        *
      from raw.jaffle_shop.orders
    ) a

    join ( 
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
    ) b
    on a.user_id = b.id

    left outer join raw.stripe.payment c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.name, b.last_name, b.first_name

) customer_order_history
on orders.user_id = customer_order_history.customer_id

left outer join raw.stripe.payment payments
on orders.id = payments.orderid

where payments.status != 'fail'
  );
[0m12:18:37.729252 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:18:39.161267 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1 seconds
[0m12:18:39.188324 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.customers (execute): 2023-04-05 12:18:37.669479 => 2023-04-05 12:18:39.188324
[0m12:18:39.189324 [debug] [Thread-2 (]: On model.upgrade_skills.customers: Close
[0m12:18:39.424076 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2 seconds
[0m12:18:39.430003 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customer_orders (execute): 2023-04-05 12:18:37.708262 => 2023-04-05 12:18:39.430003
[0m12:18:39.430003 [debug] [Thread-1 (]: On model.upgrade_skills.customer_orders: Close
[0m12:18:39.442284 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db4cc14-5b56-49d0-84a4-c6cc5f9240c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D031285D0>]}
[0m12:18:39.443365 [info ] [Thread-2 (]: 2 of 8 OK created sql view model DBT_PC_ATOS.customers ......................... [[32mSUCCESS 1[0m in 1.78s]
[0m12:18:39.445377 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.customers
[0m12:18:39.446362 [debug] [Thread-2 (]: Began running node model.upgrade_skills.stg_jaffle_shop__customers
[0m12:18:39.447381 [info ] [Thread-2 (]: 3 of 8 START sql view model DBT_PC_ATOS.stg_jaffle_shop__customers ............. [RUN]
[0m12:18:39.448364 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_jaffle_shop__customers'
[0m12:18:39.448364 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.stg_jaffle_shop__customers
[0m12:18:39.451379 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.stg_jaffle_shop__customers"
[0m12:18:39.452564 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__customers (compile): 2023-04-05 12:18:39.449361 => 2023-04-05 12:18:39.452564
[0m12:18:39.453255 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.stg_jaffle_shop__customers
[0m12:18:39.456136 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.stg_jaffle_shop__customers"
[0m12:18:39.457138 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.stg_jaffle_shop__customers"
[0m12:18:39.457138 [debug] [Thread-2 (]: On model.upgrade_skills.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.stg_jaffle_shop__customers"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__customers
  
   as (
    with

source as (

    select * from raw.jaffle_shop.customers

),

transformed as (

    select 

        id as customer_id,
        last_name as surname,
        first_name as givenname,
        first_name || ' ' || last_name as full_name

    from source

)

select * from transformed
  );
[0m12:18:39.458148 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:18:39.721334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db4cc14-5b56-49d0-84a4-c6cc5f9240c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D0301E2D0>]}
[0m12:18:39.722360 [info ] [Thread-1 (]: 1 of 8 OK created sql view model DBT_PC_ATOS.customer_orders ................... [[32mSUCCESS 1[0m in 2.07s]
[0m12:18:39.723735 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.customer_orders
[0m12:18:39.723735 [debug] [Thread-1 (]: Began running node model.upgrade_skills.stg_jaffle_shop__orders
[0m12:18:39.724719 [info ] [Thread-1 (]: 4 of 8 START sql view model DBT_PC_ATOS.stg_jaffle_shop__orders ................ [RUN]
[0m12:18:39.724719 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_jaffle_shop__orders'
[0m12:18:39.725758 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.stg_jaffle_shop__orders
[0m12:18:39.728552 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.stg_jaffle_shop__orders"
[0m12:18:39.730025 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__orders (compile): 2023-04-05 12:18:39.725758 => 2023-04-05 12:18:39.730025
[0m12:18:39.730025 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.stg_jaffle_shop__orders
[0m12:18:39.733226 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.stg_jaffle_shop__orders"
[0m12:18:39.734224 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.stg_jaffle_shop__orders"
[0m12:18:39.734224 [debug] [Thread-1 (]: On model.upgrade_skills.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.stg_jaffle_shop__orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__orders
  
   as (
    with

source as (
    
    select * from raw.jaffle_shop.orders
    
),

transformed as (
        
      select 
      
        id as order_id,
        user_id as customer_id,
        status as order_status,
        order_date,
        
        case 
            when order_status not in ('returned','return_pending') 
            then order_date 
        end as valid_order_date,
        
        row_number() over (
            partition by user_id 
            order by order_date, id
        ) as user_order_seq
        
      from source
    
)

select * from transformed
  );
[0m12:18:39.735296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:40.770006 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1 seconds
[0m12:18:40.773371 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__customers (execute): 2023-04-05 12:18:39.453255 => 2023-04-05 12:18:40.773371
[0m12:18:40.774390 [debug] [Thread-2 (]: On model.upgrade_skills.stg_jaffle_shop__customers: Close
[0m12:18:41.024991 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db4cc14-5b56-49d0-84a4-c6cc5f9240c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D036796D0>]}
[0m12:18:41.026040 [info ] [Thread-2 (]: 3 of 8 OK created sql view model DBT_PC_ATOS.stg_jaffle_shop__customers ........ [[32mSUCCESS 1[0m in 1.58s]
[0m12:18:41.027332 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.stg_jaffle_shop__customers
[0m12:18:41.028607 [debug] [Thread-2 (]: Began running node model.upgrade_skills.stg_stripe__payments
[0m12:18:41.029604 [info ] [Thread-2 (]: 5 of 8 START sql view model DBT_PC_ATOS.stg_stripe__payments ................... [RUN]
[0m12:18:41.030604 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_stripe__payments'
[0m12:18:41.031104 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.stg_stripe__payments
[0m12:18:41.035147 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.stg_stripe__payments"
[0m12:18:41.037902 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_stripe__payments (compile): 2023-04-05 12:18:41.031603 => 2023-04-05 12:18:41.037651
[0m12:18:41.038508 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.stg_stripe__payments
[0m12:18:41.043840 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.stg_stripe__payments"
[0m12:18:41.046413 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.stg_stripe__payments"
[0m12:18:41.047412 [debug] [Thread-2 (]: On model.upgrade_skills.stg_stripe__payments: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.stg_stripe__payments"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.stg_stripe__payments
  
   as (
    with

source as (

    select * from raw.stripe.payment

),

transformed as (

    select 

        id as payment_id,
        orderid as order_id,
        status as payment_status,
        round(amount/100.2, 2) as payment_amount

    from source

)

select * from transformed
  );
[0m12:18:41.047412 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:18:41.114501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m12:18:41.118648 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__orders (execute): 2023-04-05 12:18:39.731048 => 2023-04-05 12:18:41.118648
[0m12:18:41.119196 [debug] [Thread-1 (]: On model.upgrade_skills.stg_jaffle_shop__orders: Close
[0m12:18:41.369948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db4cc14-5b56-49d0-84a4-c6cc5f9240c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D036765D0>]}
[0m12:18:41.371459 [info ] [Thread-1 (]: 4 of 8 OK created sql view model DBT_PC_ATOS.stg_jaffle_shop__orders ........... [[32mSUCCESS 1[0m in 1.65s]
[0m12:18:41.373494 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.stg_jaffle_shop__orders
[0m12:18:42.511393 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1 seconds
[0m12:18:42.514335 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_stripe__payments (execute): 2023-04-05 12:18:41.038899 => 2023-04-05 12:18:42.514335
[0m12:18:42.514834 [debug] [Thread-2 (]: On model.upgrade_skills.stg_stripe__payments: Close
[0m12:18:42.832466 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db4cc14-5b56-49d0-84a4-c6cc5f9240c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D0368D150>]}
[0m12:18:42.833466 [info ] [Thread-2 (]: 5 of 8 OK created sql view model DBT_PC_ATOS.stg_stripe__payments .............. [[32mSUCCESS 1[0m in 1.80s]
[0m12:18:42.834449 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.stg_stripe__payments
[0m12:18:42.835718 [debug] [Thread-1 (]: Began running node model.upgrade_skills.int_orders
[0m12:18:42.836639 [info ] [Thread-1 (]: 6 of 8 START sql view model DBT_PC_ATOS.int_orders ............................. [RUN]
[0m12:18:42.838134 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.int_orders'
[0m12:18:42.839514 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.int_orders
[0m12:18:42.846539 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.int_orders"
[0m12:18:42.850132 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.int_orders (compile): 2023-04-05 12:18:42.840133 => 2023-04-05 12:18:42.849632
[0m12:18:42.851533 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.int_orders
[0m12:18:42.861829 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.int_orders"
[0m12:18:42.864742 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.int_orders"
[0m12:18:42.865742 [debug] [Thread-1 (]: On model.upgrade_skills.int_orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.int_orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.int_orders
  
   as (
    with

orders as (

    select * from PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__orders

),

payments as (

    select * from PC_DBT_DB.DBT_PC_ATOS.stg_stripe__payments
    where payment_status != 'fail'

),

order_totals as (

    select

        order_id,
        payment_status,
        sum(payment_amount) as order_value_dollars

    from payments
    group by 1, 2

),

joined as (

    select

        orders.*,
        order_totals.payment_status,
        order_totals.order_value_dollars

    from orders 
    left join order_totals
        on orders.order_id = order_totals.order_id

)

select * from joined
  );
[0m12:18:42.866242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:44.162790 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m12:18:44.167650 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.int_orders (execute): 2023-04-05 12:18:42.852764 => 2023-04-05 12:18:44.167650
[0m12:18:44.168722 [debug] [Thread-1 (]: On model.upgrade_skills.int_orders: Close
[0m12:18:44.449000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db4cc14-5b56-49d0-84a4-c6cc5f9240c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D0368EA10>]}
[0m12:18:44.450032 [info ] [Thread-1 (]: 6 of 8 OK created sql view model DBT_PC_ATOS.int_orders ........................ [[32mSUCCESS 1[0m in 1.61s]
[0m12:18:44.451210 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.int_orders
[0m12:18:44.451210 [debug] [Thread-2 (]: Began running node model.upgrade_skills.fct_customer_orders
[0m12:18:44.452373 [debug] [Thread-1 (]: Began running node model.upgrade_skills.final_model
[0m12:18:44.453442 [info ] [Thread-2 (]: 7 of 8 START sql view model DBT_PC_ATOS.fct_customer_orders .................... [RUN]
[0m12:18:44.454443 [info ] [Thread-1 (]: 8 of 8 START sql view model DBT_PC_ATOS.final_model ............................ [RUN]
[0m12:18:44.455147 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.fct_customer_orders'
[0m12:18:44.456390 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.final_model'
[0m12:18:44.456390 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.fct_customer_orders
[0m12:18:44.457604 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.final_model
[0m12:18:44.460752 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.fct_customer_orders"
[0m12:18:44.464369 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.final_model"
[0m12:18:44.466561 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.final_model (compile): 2023-04-05 12:18:44.460752 => 2023-04-05 12:18:44.466061
[0m12:18:44.466561 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.fct_customer_orders (compile): 2023-04-05 12:18:44.457604 => 2023-04-05 12:18:44.466561
[0m12:18:44.467060 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.final_model
[0m12:18:44.467873 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.fct_customer_orders
[0m12:18:44.471812 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.final_model"
[0m12:18:44.474725 [debug] [Thread-2 (]: Writing runtime sql for node "model.upgrade_skills.fct_customer_orders"
[0m12:18:44.476798 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.final_model"
[0m12:18:44.479098 [debug] [Thread-2 (]: Using snowflake connection "model.upgrade_skills.fct_customer_orders"
[0m12:18:44.479098 [debug] [Thread-1 (]: On model.upgrade_skills.final_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.final_model"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.final_model
  
   as (
    with 

orders as (

  select * from PC_DBT_DB.DBT_PC_ATOS.int_orders

),

customers as (

  select * from PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__customers

),

customer_orders as (

  select 

    orders.*,
    customers.full_name,
    customers.surname,
    customers.givenname,

    --- Customer level aggregations
    min(orders.order_date) over(
      partition by orders.customer_id
    ) as customer_first_order_date,

    min(orders.valid_order_date) over(
      partition by orders.customer_id
    ) as customer_first_non_returned_order_date,

    max(orders.valid_order_date) over(
      partition by orders.customer_id
    ) as customer_most_recent_non_returned_order_date,

    count(*) over(
      partition by orders.customer_id
    ) as customer_order_count,

    sum(nvl2(orders.valid_order_date, 1, 0)) over(
      partition by orders.customer_id
    ) as customer_non_returned_order_count,

    sum(nvl2(orders.valid_order_date, orders.order_value_dollars, 0)) over(
      partition by orders.customer_id
    ) as customer_total_lifetime_value,

    array_agg(distinct orders.order_id) over(
      partition by orders.customer_id
    ) as customer_order_ids

  from orders
  inner join customers
    on orders.customer_id = customers.customer_id

),

add_avg_order_values as (

  select

    *,

    customer_total_lifetime_value / customer_non_returned_order_count 
    as customer_avg_non_returned_order_value

  from customer_orders

),

final as (

  select 

    order_id,
    customer_id,
    surname,
    givenname,
    customer_first_order_date as first_order_date,
    customer_order_count as order_count,
    customer_total_lifetime_value as total_lifetime_value,
    order_value_dollars,
    order_status,
    payment_status

  from add_avg_order_values

)

select * from final
  );
[0m12:18:44.480099 [debug] [Thread-2 (]: On model.upgrade_skills.fct_customer_orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.fct_customer_orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.fct_customer_orders
  
   as (
    with

customers as (

    select * from PC_DBT_DB.DBT_PC_ATOS.stg_jaffle_shop__customers

),

orders as (

    select * from PC_DBT_DB.DBT_PC_ATOS.int_orders

),

final as (

    select

        orders.*,

        customers.surname,
        customers.givenname,

        -- Customer-level aggregations
        min(orders.order_date) over(
            partition by orders.customer_id
        ) as first_order_date,

        min(orders.valid_order_date) over(
            partition by orders.customer_id
        ) as first_non_returned_order_date,

        max(orders.valid_order_date) over(
            partition by orders.customer_id
        ) as most_recent_non_returned_order_date,

        count(*) over(
            partition by orders.customer_id
        ) as order_count,

        sum(nvl2(orders.valid_order_date, 1, 0)) over(
            partition by orders.customer_id
        ) as non_returned_order_count,

        array_agg(distinct orders.order_id) over(
            partition by orders.customer_id
        ) as order_ids,

        sum(nvl2(orders.valid_order_date, orders.order_value_dollars, 0)) over(
            partition by orders.customer_id
        ) as total_lifetime_value

    from orders
    inner join customers
        on orders.customer_id = customers.customer_id

)

select * from final
  );
[0m12:18:44.480099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:44.480891 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:18:45.943322 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m12:18:45.946031 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.final_model (execute): 2023-04-05 12:18:44.468424 => 2023-04-05 12:18:45.946031
[0m12:18:45.947395 [debug] [Thread-1 (]: On model.upgrade_skills.final_model: Close
[0m12:18:45.965352 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1 seconds
[0m12:18:45.968370 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.fct_customer_orders (execute): 2023-04-05 12:18:44.471812 => 2023-04-05 12:18:45.968370
[0m12:18:45.969692 [debug] [Thread-2 (]: On model.upgrade_skills.fct_customer_orders: Close
[0m12:18:46.204214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db4cc14-5b56-49d0-84a4-c6cc5f9240c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D03134050>]}
[0m12:18:46.205159 [info ] [Thread-1 (]: 8 of 8 OK created sql view model DBT_PC_ATOS.final_model ....................... [[32mSUCCESS 1[0m in 1.75s]
[0m12:18:46.207172 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.final_model
[0m12:18:46.283625 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db4cc14-5b56-49d0-84a4-c6cc5f9240c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D03069390>]}
[0m12:18:46.283625 [info ] [Thread-2 (]: 7 of 8 OK created sql view model DBT_PC_ATOS.fct_customer_orders ............... [[32mSUCCESS 1[0m in 1.83s]
[0m12:18:46.284612 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.fct_customer_orders
[0m12:18:46.286628 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:18:46.287713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:46.287713 [debug] [MainThread]: Connection 'create_PC_DBT_DB_DBT_PC_ATOS' was properly closed.
[0m12:18:46.287713 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_PC_ATOS' was properly closed.
[0m12:18:46.288626 [debug] [MainThread]: Connection 'model.upgrade_skills.final_model' was properly closed.
[0m12:18:46.288626 [debug] [MainThread]: Connection 'model.upgrade_skills.fct_customer_orders' was properly closed.
[0m12:18:46.288626 [info ] [MainThread]: 
[0m12:18:46.289611 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 14.49 seconds (14.49s).
[0m12:18:46.290197 [debug] [MainThread]: Command end result
[0m12:18:46.296230 [info ] [MainThread]: 
[0m12:18:46.296230 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:18:46.297229 [info ] [MainThread]: 
[0m12:18:46.297779 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m12:18:46.298518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D0309A590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D014775D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CFD574050>]}
[0m12:18:46.298894 [debug] [MainThread]: Flushing usage events


============================== 2023-04-05 12:19:59.364161 | 3e89e234-bf14-4b1a-98b7-3dfcbee1679f ==============================
[0m12:19:59.364161 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:19:59.365162 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:19:59.366165 [debug] [MainThread]: Tracking: tracking
[0m12:19:59.366165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266BC06190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266CBBB110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266D0AFC90>]}
[0m12:19:59.373432 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:19:59.398434 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:19:59.399462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3e89e234-bf14-4b1a-98b7-3dfcbee1679f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266D1D28D0>]}
[0m12:19:59.944021 [debug] [MainThread]: 1699: static parser successfully parsed compute\final_model.sql
[0m12:19:59.962362 [debug] [MainThread]: 1699: static parser successfully parsed compute\int_orders.sql
[0m12:19:59.969046 [debug] [MainThread]: 1699: static parser successfully parsed publish\customer_orders.sql
[0m12:19:59.972569 [debug] [MainThread]: 1699: static parser successfully parsed publish\fct_customer_orders.sql
[0m12:19:59.976942 [debug] [MainThread]: 1699: static parser successfully parsed staging\customers.sql
[0m12:19:59.984403 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__customers.sql
[0m12:19:59.991173 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__orders.sql
[0m12:19:59.996503 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_stripe__payments.sql
[0m12:20:00.061632 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.upgrade_skills.published
[0m12:20:00.068860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e89e234-bf14-4b1a-98b7-3dfcbee1679f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266D12A390>]}
[0m12:20:00.077420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e89e234-bf14-4b1a-98b7-3dfcbee1679f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266D1F1410>]}
[0m12:20:00.078307 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 306 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:20:00.078792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e89e234-bf14-4b1a-98b7-3dfcbee1679f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266D129790>]}
[0m12:20:00.080795 [info ] [MainThread]: 
[0m12:20:00.081796 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:20:00.084551 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m12:20:00.099498 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m12:20:00.100789 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m12:20:00.101590 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m12:20:00.104147 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m12:20:00.104147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:00.105045 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m12:20:00.106939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:01.689640 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2 seconds
[0m12:20:01.690639 [debug] [ThreadPool]: On list_PC_DBT_DB: Close
[0m12:20:01.718642 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2 seconds
[0m12:20:01.721645 [debug] [ThreadPool]: On list_PC_DBT_DB: Close
[0m12:20:01.992555 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m12:20:01.997557 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m12:20:01.998871 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m12:20:02.000240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:03.174276 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:20:03.177269 [debug] [ThreadPool]: On list_PC_DBT_DB: Close
[0m12:20:03.471880 [debug] [ThreadPool]: Acquiring new snowflake connection 'create_PC_DBT_DB_DBT_PC_ATOS_staging'
[0m12:20:03.472922 [debug] [ThreadPool]: Acquiring new snowflake connection 'create_PC_DBT_DB_DBT_PC_ATOS_compute'
[0m12:20:03.474794 [debug] [ThreadPool]: Acquiring new snowflake connection 'create_PC_DBT_DB_DBT_PC_ATOS_staging'
[0m12:20:03.477174 [debug] [ThreadPool]: Acquiring new snowflake connection 'create_PC_DBT_DB_DBT_PC_ATOS_compute'
[0m12:20:03.478374 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='pc_dbt_db', schema='dbt_pc_atos_staging', identifier=None)"
[0m12:20:03.479314 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='pc_dbt_db', schema='dbt_pc_atos_compute', identifier=None)"
[0m12:20:03.489535 [debug] [ThreadPool]: Using snowflake connection "create_PC_DBT_DB_DBT_PC_ATOS_staging"
[0m12:20:03.492638 [debug] [ThreadPool]: Using snowflake connection "create_PC_DBT_DB_DBT_PC_ATOS_compute"
[0m12:20:03.492638 [debug] [ThreadPool]: On create_PC_DBT_DB_DBT_PC_ATOS_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "create_PC_DBT_DB_DBT_PC_ATOS_staging"} */
create schema if not exists PC_DBT_DB.DBT_PC_ATOS_staging
[0m12:20:03.493634 [debug] [ThreadPool]: On create_PC_DBT_DB_DBT_PC_ATOS_compute: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "create_PC_DBT_DB_DBT_PC_ATOS_compute"} */
create schema if not exists PC_DBT_DB.DBT_PC_ATOS_compute
[0m12:20:03.493634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:03.494660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:04.783046 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1 seconds
[0m12:20:04.783752 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1 seconds
[0m12:20:04.783752 [debug] [ThreadPool]: On create_PC_DBT_DB_DBT_PC_ATOS_compute: Close
[0m12:20:04.786000 [debug] [ThreadPool]: On create_PC_DBT_DB_DBT_PC_ATOS_staging: Close
[0m12:20:05.060610 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_PC_ATOS'
[0m12:20:05.061532 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_PC_ATOS_staging'
[0m12:20:05.066626 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_PC_ATOS"
[0m12:20:05.069526 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_PC_ATOS_staging"
[0m12:20:05.069526 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB_DBT_PC_ATOS"} */
show terse objects in PC_DBT_DB.DBT_PC_ATOS
[0m12:20:05.070628 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB_DBT_PC_ATOS_staging"} */
show terse objects in PC_DBT_DB.DBT_PC_ATOS_staging
[0m12:20:05.070628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:05.071567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:06.524597 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:20:06.528641 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS: Close
[0m12:20:06.539867 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1 seconds
[0m12:20:06.541899 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS_staging: Close
[0m12:20:06.853299 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_PC_ATOS_compute'
[0m12:20:06.858381 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_PC_ATOS_compute"
[0m12:20:06.863392 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS_compute: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB_DBT_PC_ATOS_compute"} */
show terse objects in PC_DBT_DB.DBT_PC_ATOS_compute
[0m12:20:06.864367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:07.893846 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1 seconds
[0m12:20:07.896835 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS_compute: Close
[0m12:20:08.161627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e89e234-bf14-4b1a-98b7-3dfcbee1679f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266C35AF90>]}
[0m12:20:08.163564 [info ] [MainThread]: Concurrency: 2 threads (target='snow')
[0m12:20:08.164641 [info ] [MainThread]: 
[0m12:20:08.172153 [debug] [Thread-1 (]: Began running node model.upgrade_skills.customer_orders
[0m12:20:08.173197 [debug] [Thread-2 (]: Began running node model.upgrade_skills.customers
[0m12:20:08.173197 [info ] [Thread-1 (]: 1 of 8 START sql view model DBT_PC_ATOS.customer_orders ........................ [RUN]
[0m12:20:08.174249 [info ] [Thread-2 (]: 2 of 8 START sql views model DBT_PC_ATOS_staging.customers ..................... [RUN]
[0m12:20:08.175920 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.customer_orders'
[0m12:20:08.177221 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.customers'
[0m12:20:08.177221 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.customer_orders
[0m12:20:08.178190 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.customers
[0m12:20:08.179923 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.customer_orders"
[0m12:20:08.182172 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.customers"
[0m12:20:08.183172 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.customers (compile): 2023-04-05 12:20:08.179923 => 2023-04-05 12:20:08.183172
[0m12:20:08.183776 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customer_orders (compile): 2023-04-05 12:20:08.178714 => 2023-04-05 12:20:08.183776
[0m12:20:08.183776 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.customers
[0m12:20:08.183776 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.customer_orders
[0m12:20:08.186370 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.customers (execute): 2023-04-05 12:20:08.185169 => 2023-04-05 12:20:08.186370
[0m12:20:08.210727 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.customer_orders"
[0m12:20:08.214652 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.customer_orders"
[0m12:20:08.214652 [debug] [Thread-1 (]: On model.upgrade_skills.customer_orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.customer_orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.customer_orders
  
   as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    last_name as surname,
    first_name as givenname,
    first_order_date,
    order_count,
    total_lifetime_value,
    round(amount/100.0,2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
from raw.jaffle_shop.orders as orders

join (
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
) customers
on orders.user_id = customers.id

join (

    select 
        b.id as customer_id,
        b.name as full_name,
        b.last_name as surname,
        b.first_name as givenname,
        min(order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then order_date end) as most_recent_non_returned_order_date,
        COALESCE(max(user_order_seq),0) as order_count,
        COALESCE(count(case when a.status != 'returned' then 1 end),0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end)/NULLIF(count(case when a.status NOT IN ('returned','return_pending') then 1 end),0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
      select 
        row_number() over (partition by user_id order by order_date, id) as user_order_seq,
        *
      from raw.jaffle_shop.orders
    ) a

    join ( 
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
    ) b
    on a.user_id = b.id

    left outer join raw.stripe.payment c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.name, b.last_name, b.first_name

) customer_order_history
on orders.user_id = customer_order_history.customer_id

left outer join raw.stripe.payment payments
on orders.id = payments.orderid

where payments.status != 'fail'
  );
[0m12:20:08.215652 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:20:08.245818 [debug] [Thread-2 (]: Compilation Error in model customers (models\staging\customers.sql)
  No materialization 'views' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:20:08.245818 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e89e234-bf14-4b1a-98b7-3dfcbee1679f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266DA59290>]}
[0m12:20:08.246811 [error] [Thread-2 (]: 2 of 8 ERROR creating sql views model DBT_PC_ATOS_staging.customers ............ [[31mERROR[0m in 0.07s]
[0m12:20:08.248886 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.customers
[0m12:20:08.248886 [debug] [Thread-2 (]: Began running node model.upgrade_skills.stg_jaffle_shop__customers
[0m12:20:08.249807 [info ] [Thread-2 (]: 3 of 8 START sql views model DBT_PC_ATOS_staging.stg_jaffle_shop__customers .... [RUN]
[0m12:20:08.250807 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_jaffle_shop__customers'
[0m12:20:08.250807 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.stg_jaffle_shop__customers
[0m12:20:08.252893 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.stg_jaffle_shop__customers"
[0m12:20:08.253900 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__customers (compile): 2023-04-05 12:20:08.251902 => 2023-04-05 12:20:08.253900
[0m12:20:08.254808 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.stg_jaffle_shop__customers
[0m12:20:08.256336 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__customers (execute): 2023-04-05 12:20:08.255285 => 2023-04-05 12:20:08.256336
[0m12:20:08.257336 [debug] [Thread-2 (]: Compilation Error in model stg_jaffle_shop__customers (models\staging\stg_jaffle_shop__customers.sql)
  No materialization 'views' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:20:08.258336 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e89e234-bf14-4b1a-98b7-3dfcbee1679f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266D6B3910>]}
[0m12:20:08.258336 [error] [Thread-2 (]: 3 of 8 ERROR creating sql views model DBT_PC_ATOS_staging.stg_jaffle_shop__customers  [[31mERROR[0m in 0.01s]
[0m12:20:08.259335 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.stg_jaffle_shop__customers
[0m12:20:08.259335 [debug] [Thread-2 (]: Began running node model.upgrade_skills.stg_jaffle_shop__orders
[0m12:20:08.260335 [info ] [Thread-2 (]: 4 of 8 START sql views model DBT_PC_ATOS_staging.stg_jaffle_shop__orders ....... [RUN]
[0m12:20:08.261241 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_jaffle_shop__orders'
[0m12:20:08.261474 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.stg_jaffle_shop__orders
[0m12:20:08.263487 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.stg_jaffle_shop__orders"
[0m12:20:08.264494 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__orders (compile): 2023-04-05 12:20:08.261474 => 2023-04-05 12:20:08.263487
[0m12:20:08.265120 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.stg_jaffle_shop__orders
[0m12:20:08.266731 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__orders (execute): 2023-04-05 12:20:08.265722 => 2023-04-05 12:20:08.266731
[0m12:20:08.267317 [debug] [Thread-2 (]: Compilation Error in model stg_jaffle_shop__orders (models\staging\stg_jaffle_shop__orders.sql)
  No materialization 'views' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:20:08.267317 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e89e234-bf14-4b1a-98b7-3dfcbee1679f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266D6F1790>]}
[0m12:20:08.268499 [error] [Thread-2 (]: 4 of 8 ERROR creating sql views model DBT_PC_ATOS_staging.stg_jaffle_shop__orders  [[31mERROR[0m in 0.01s]
[0m12:20:08.268499 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.stg_jaffle_shop__orders
[0m12:20:08.269525 [debug] [Thread-2 (]: Began running node model.upgrade_skills.stg_stripe__payments
[0m12:20:08.270562 [info ] [Thread-2 (]: 5 of 8 START sql views model DBT_PC_ATOS_staging.stg_stripe__payments .......... [RUN]
[0m12:20:08.271193 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_stripe__payments'
[0m12:20:08.271193 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.stg_stripe__payments
[0m12:20:08.273315 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.stg_stripe__payments"
[0m12:20:08.274677 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_stripe__payments (compile): 2023-04-05 12:20:08.271193 => 2023-04-05 12:20:08.274677
[0m12:20:08.275437 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.stg_stripe__payments
[0m12:20:08.276802 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_stripe__payments (execute): 2023-04-05 12:20:08.275437 => 2023-04-05 12:20:08.276802
[0m12:20:08.277802 [debug] [Thread-2 (]: Compilation Error in model stg_stripe__payments (models\staging\stg_stripe__payments.sql)
  No materialization 'views' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:20:08.277802 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e89e234-bf14-4b1a-98b7-3dfcbee1679f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266D218B90>]}
[0m12:20:08.277802 [error] [Thread-2 (]: 5 of 8 ERROR creating sql views model DBT_PC_ATOS_staging.stg_stripe__payments . [[31mERROR[0m in 0.01s]
[0m12:20:08.278801 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.stg_stripe__payments
[0m12:20:08.279801 [debug] [Thread-2 (]: Began running node model.upgrade_skills.int_orders
[0m12:20:08.280468 [info ] [Thread-2 (]: 6 of 8 SKIP relation DBT_PC_ATOS_compute.int_orders ............................ [[33mSKIP[0m]
[0m12:20:08.281136 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.int_orders
[0m12:20:08.281902 [debug] [Thread-2 (]: Began running node model.upgrade_skills.fct_customer_orders
[0m12:20:08.282280 [info ] [Thread-2 (]: 7 of 8 SKIP relation DBT_PC_ATOS.fct_customer_orders ........................... [[33mSKIP[0m]
[0m12:20:08.282833 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.fct_customer_orders
[0m12:20:08.283280 [debug] [Thread-2 (]: Began running node model.upgrade_skills.final_model
[0m12:20:08.283826 [info ] [Thread-2 (]: 8 of 8 SKIP relation DBT_PC_ATOS_compute.final_model ........................... [[33mSKIP[0m]
[0m12:20:08.284279 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.final_model
[0m12:20:09.255449 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m12:20:09.274541 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customer_orders (execute): 2023-04-05 12:20:08.187647 => 2023-04-05 12:20:09.274541
[0m12:20:09.274541 [debug] [Thread-1 (]: On model.upgrade_skills.customer_orders: Close
[0m12:20:09.565355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e89e234-bf14-4b1a-98b7-3dfcbee1679f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266D202B50>]}
[0m12:20:09.566341 [info ] [Thread-1 (]: 1 of 8 OK created sql view model DBT_PC_ATOS.customer_orders ................... [[32mSUCCESS 1[0m in 1.39s]
[0m12:20:09.567268 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.customer_orders
[0m12:20:09.571341 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:20:09.572301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:20:09.572301 [debug] [MainThread]: Connection 'create_PC_DBT_DB_DBT_PC_ATOS_compute' was properly closed.
[0m12:20:09.573264 [debug] [MainThread]: Connection 'create_PC_DBT_DB_DBT_PC_ATOS_staging' was properly closed.
[0m12:20:09.573264 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_PC_ATOS' was properly closed.
[0m12:20:09.574343 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_PC_ATOS_compute' was properly closed.
[0m12:20:09.574889 [debug] [MainThread]: Connection 'model.upgrade_skills.customer_orders' was properly closed.
[0m12:20:09.574889 [debug] [MainThread]: Connection 'model.upgrade_skills.stg_stripe__payments' was properly closed.
[0m12:20:09.575638 [info ] [MainThread]: 
[0m12:20:09.575638 [info ] [MainThread]: Finished running 4 views models, 2 table models, 2 view models in 0 hours 0 minutes and 9.49 seconds (9.49s).
[0m12:20:09.576667 [debug] [MainThread]: Command end result
[0m12:20:09.581672 [info ] [MainThread]: 
[0m12:20:09.582714 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m12:20:09.582714 [info ] [MainThread]: 
[0m12:20:09.583733 [error] [MainThread]: [33mCompilation Error in model customers (models\staging\customers.sql)[0m
[0m12:20:09.583733 [error] [MainThread]:   No materialization 'views' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:20:09.583733 [info ] [MainThread]: 
[0m12:20:09.584875 [error] [MainThread]: [33mCompilation Error in model stg_jaffle_shop__customers (models\staging\stg_jaffle_shop__customers.sql)[0m
[0m12:20:09.585164 [error] [MainThread]:   No materialization 'views' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:20:09.585164 [info ] [MainThread]: 
[0m12:20:09.586293 [error] [MainThread]: [33mCompilation Error in model stg_jaffle_shop__orders (models\staging\stg_jaffle_shop__orders.sql)[0m
[0m12:20:09.586716 [error] [MainThread]:   No materialization 'views' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:20:09.587067 [info ] [MainThread]: 
[0m12:20:09.587496 [error] [MainThread]: [33mCompilation Error in model stg_stripe__payments (models\staging\stg_stripe__payments.sql)[0m
[0m12:20:09.587496 [error] [MainThread]:   No materialization 'views' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:20:09.588541 [info ] [MainThread]: 
[0m12:20:09.588920 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=4 SKIP=3 TOTAL=8
[0m12:20:09.588920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266CBD4110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266CBD5150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002266D124450>]}
[0m12:20:09.589964 [debug] [MainThread]: Flushing usage events


============================== 2023-04-05 12:20:49.606071 | 05426c31-ef23-4344-90a2-91729b45b678 ==============================
[0m12:20:49.606071 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:20:49.608071 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\a891348\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:20:49.608071 [debug] [MainThread]: Tracking: tracking
[0m12:20:49.609347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020203CBFF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202042FC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020204306B10>]}
[0m12:20:49.617371 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:20:49.640810 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:20:49.641719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05426c31-ef23-4344-90a2-91729b45b678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020202748510>]}
[0m12:20:50.200618 [debug] [MainThread]: 1699: static parser successfully parsed compute\final_model.sql
[0m12:20:50.215687 [debug] [MainThread]: 1699: static parser successfully parsed compute\int_orders.sql
[0m12:20:50.221286 [debug] [MainThread]: 1699: static parser successfully parsed publish\customer_orders.sql
[0m12:20:50.229265 [debug] [MainThread]: 1699: static parser successfully parsed publish\fct_customer_orders.sql
[0m12:20:50.234478 [debug] [MainThread]: 1699: static parser successfully parsed staging\customers.sql
[0m12:20:50.240457 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__customers.sql
[0m12:20:50.244241 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_jaffle_shop__orders.sql
[0m12:20:50.248377 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_stripe__payments.sql
[0m12:20:50.304591 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.upgrade_skills.published
[0m12:20:50.314458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05426c31-ef23-4344-90a2-91729b45b678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202042EAC90>]}
[0m12:20:50.322671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05426c31-ef23-4344-90a2-91729b45b678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020204460950>]}
[0m12:20:50.323768 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 306 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:20:50.324522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05426c31-ef23-4344-90a2-91729b45b678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202042E31D0>]}
[0m12:20:50.325571 [info ] [MainThread]: 
[0m12:20:50.328486 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:20:50.331461 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m12:20:50.333135 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m12:20:50.352620 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m12:20:50.354610 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m12:20:50.355609 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m12:20:50.355609 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m12:20:50.357041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:50.357041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:52.000893 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 2 seconds
[0m12:20:52.004595 [debug] [ThreadPool]: On list_PC_DBT_DB: Close
[0m12:20:52.007718 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 2 seconds
[0m12:20:52.012724 [debug] [ThreadPool]: On list_PC_DBT_DB: Close
[0m12:20:52.294401 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m12:20:52.298405 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m12:20:52.299575 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m12:20:52.300520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:53.350586 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1 seconds
[0m12:20:53.355591 [debug] [ThreadPool]: On list_PC_DBT_DB: Close
[0m12:20:53.615072 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_PC_ATOS_compute'
[0m12:20:53.617040 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_PC_ATOS'
[0m12:20:53.635523 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_PC_ATOS_compute"
[0m12:20:53.639532 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_PC_ATOS"
[0m12:20:53.640525 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS_compute: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB_DBT_PC_ATOS_compute"} */
show terse objects in PC_DBT_DB.DBT_PC_ATOS_compute
[0m12:20:53.641532 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB_DBT_PC_ATOS"} */
show terse objects in PC_DBT_DB.DBT_PC_ATOS
[0m12:20:53.641532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:53.642463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:55.134222 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1 seconds
[0m12:20:55.135215 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1 seconds
[0m12:20:55.139210 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS: Close
[0m12:20:55.141231 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS_compute: Close
[0m12:20:55.396349 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_PC_ATOS_staging'
[0m12:20:55.400518 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_PC_ATOS_staging"
[0m12:20:55.404186 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "connection_name": "list_PC_DBT_DB_DBT_PC_ATOS_staging"} */
show terse objects in PC_DBT_DB.DBT_PC_ATOS_staging
[0m12:20:55.405914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:56.663511 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1 seconds
[0m12:20:56.666504 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_PC_ATOS_staging: Close
[0m12:20:56.925555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05426c31-ef23-4344-90a2-91729b45b678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202044FE290>]}
[0m12:20:56.927544 [info ] [MainThread]: Concurrency: 2 threads (target='snow')
[0m12:20:56.928577 [info ] [MainThread]: 
[0m12:20:56.940508 [debug] [Thread-1 (]: Began running node model.upgrade_skills.customer_orders
[0m12:20:56.941552 [debug] [Thread-2 (]: Began running node model.upgrade_skills.customers
[0m12:20:56.942086 [info ] [Thread-1 (]: 1 of 8 START sql view model DBT_PC_ATOS.customer_orders ........................ [RUN]
[0m12:20:56.944891 [info ] [Thread-2 (]: 2 of 8 START sql default model DBT_PC_ATOS_staging.customers ................... [RUN]
[0m12:20:56.947208 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.upgrade_skills.customer_orders'
[0m12:20:56.949395 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.customers'
[0m12:20:56.950387 [debug] [Thread-1 (]: Began compiling node model.upgrade_skills.customer_orders
[0m12:20:56.951430 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.customers
[0m12:20:56.954600 [debug] [Thread-1 (]: Writing injected SQL for node "model.upgrade_skills.customer_orders"
[0m12:20:56.960514 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.customers"
[0m12:20:56.963517 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customer_orders (compile): 2023-04-05 12:20:56.952532 => 2023-04-05 12:20:56.962516
[0m12:20:56.964653 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.customers (compile): 2023-04-05 12:20:56.955608 => 2023-04-05 12:20:56.964653
[0m12:20:56.964653 [debug] [Thread-1 (]: Began executing node model.upgrade_skills.customer_orders
[0m12:20:56.965687 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.customers
[0m12:20:57.013489 [debug] [Thread-1 (]: Writing runtime sql for node "model.upgrade_skills.customer_orders"
[0m12:20:57.016953 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.customers (execute): 2023-04-05 12:20:57.014491 => 2023-04-05 12:20:57.016953
[0m12:20:57.020643 [debug] [Thread-1 (]: Using snowflake connection "model.upgrade_skills.customer_orders"
[0m12:20:57.021727 [debug] [Thread-1 (]: On model.upgrade_skills.customer_orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "upgrade_skills", "target_name": "snow", "node_id": "model.upgrade_skills.customer_orders"} */
create or replace   view PC_DBT_DB.DBT_PC_ATOS.customer_orders
  
   as (
    select 
    orders.id as order_id,
    orders.user_id as customer_id,
    last_name as surname,
    first_name as givenname,
    first_order_date,
    order_count,
    total_lifetime_value,
    round(amount/100.0,2) as order_value_dollars,
    orders.status as order_status,
    payments.status as payment_status
from raw.jaffle_shop.orders as orders

join (
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
) customers
on orders.user_id = customers.id

join (

    select 
        b.id as customer_id,
        b.name as full_name,
        b.last_name as surname,
        b.first_name as givenname,
        min(order_date) as first_order_date,
        min(case when a.status NOT IN ('returned','return_pending') then order_date end) as first_non_returned_order_date,
        max(case when a.status NOT IN ('returned','return_pending') then order_date end) as most_recent_non_returned_order_date,
        COALESCE(max(user_order_seq),0) as order_count,
        COALESCE(count(case when a.status != 'returned' then 1 end),0) as non_returned_order_count,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end) as total_lifetime_value,
        sum(case when a.status NOT IN ('returned','return_pending') then ROUND(c.amount/100.0,2) else 0 end)/NULLIF(count(case when a.status NOT IN ('returned','return_pending') then 1 end),0) as avg_non_returned_order_value,
        array_agg(distinct a.id) as order_ids

    from (
      select 
        row_number() over (partition by user_id order by order_date, id) as user_order_seq,
        *
      from raw.jaffle_shop.orders
    ) a

    join ( 
      select 
        first_name || ' ' || last_name as name, 
        * 
      from raw.jaffle_shop.customers
    ) b
    on a.user_id = b.id

    left outer join raw.stripe.payment c
    on a.id = c.orderid

    where a.status NOT IN ('pending') and c.status != 'fail'

    group by b.id, b.name, b.last_name, b.first_name

) customer_order_history
on orders.user_id = customer_order_history.customer_id

left outer join raw.stripe.payment payments
on orders.id = payments.orderid

where payments.status != 'fail'
  );
[0m12:20:57.022734 [debug] [Thread-2 (]: Compilation Error in model customers (models\staging\customers.sql)
  No materialization 'default' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:20:57.023764 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:20:57.024754 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05426c31-ef23-4344-90a2-91729b45b678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202048F8290>]}
[0m12:20:57.027760 [error] [Thread-2 (]: 2 of 8 ERROR creating sql default model DBT_PC_ATOS_staging.customers .......... [[31mERROR[0m in 0.08s]
[0m12:20:57.029885 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.customers
[0m12:20:57.030884 [debug] [Thread-2 (]: Began running node model.upgrade_skills.stg_jaffle_shop__customers
[0m12:20:57.032907 [info ] [Thread-2 (]: 3 of 8 START sql default model DBT_PC_ATOS_staging.stg_jaffle_shop__customers .. [RUN]
[0m12:20:57.034010 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_jaffle_shop__customers'
[0m12:20:57.035677 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.stg_jaffle_shop__customers
[0m12:20:57.042171 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.stg_jaffle_shop__customers"
[0m12:20:57.044215 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__customers (compile): 2023-04-05 12:20:57.036218 => 2023-04-05 12:20:57.044215
[0m12:20:57.044672 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.stg_jaffle_shop__customers
[0m12:20:57.046840 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__customers (execute): 2023-04-05 12:20:57.045270 => 2023-04-05 12:20:57.046840
[0m12:20:57.047829 [debug] [Thread-2 (]: Compilation Error in model stg_jaffle_shop__customers (models\staging\stg_jaffle_shop__customers.sql)
  No materialization 'default' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:20:57.047829 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05426c31-ef23-4344-90a2-91729b45b678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020204C42B10>]}
[0m12:20:57.048938 [error] [Thread-2 (]: 3 of 8 ERROR creating sql default model DBT_PC_ATOS_staging.stg_jaffle_shop__customers  [[31mERROR[0m in 0.01s]
[0m12:20:57.050235 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.stg_jaffle_shop__customers
[0m12:20:57.050235 [debug] [Thread-2 (]: Began running node model.upgrade_skills.stg_jaffle_shop__orders
[0m12:20:57.051302 [info ] [Thread-2 (]: 4 of 8 START sql default model DBT_PC_ATOS_staging.stg_jaffle_shop__orders ..... [RUN]
[0m12:20:57.052255 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_jaffle_shop__orders'
[0m12:20:57.053256 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.stg_jaffle_shop__orders
[0m12:20:57.056634 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.stg_jaffle_shop__orders"
[0m12:20:57.057545 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__orders (compile): 2023-04-05 12:20:57.053533 => 2023-04-05 12:20:57.057545
[0m12:20:57.058916 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.stg_jaffle_shop__orders
[0m12:20:57.060331 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_jaffle_shop__orders (execute): 2023-04-05 12:20:57.058975 => 2023-04-05 12:20:57.060331
[0m12:20:57.061367 [debug] [Thread-2 (]: Compilation Error in model stg_jaffle_shop__orders (models\staging\stg_jaffle_shop__orders.sql)
  No materialization 'default' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:20:57.062431 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05426c31-ef23-4344-90a2-91729b45b678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020204C803D0>]}
[0m12:20:57.062431 [error] [Thread-2 (]: 4 of 8 ERROR creating sql default model DBT_PC_ATOS_staging.stg_jaffle_shop__orders  [[31mERROR[0m in 0.01s]
[0m12:20:57.063407 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.stg_jaffle_shop__orders
[0m12:20:57.064360 [debug] [Thread-2 (]: Began running node model.upgrade_skills.stg_stripe__payments
[0m12:20:57.064848 [info ] [Thread-2 (]: 5 of 8 START sql default model DBT_PC_ATOS_staging.stg_stripe__payments ........ [RUN]
[0m12:20:57.065833 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.upgrade_skills.stg_stripe__payments'
[0m12:20:57.066333 [debug] [Thread-2 (]: Began compiling node model.upgrade_skills.stg_stripe__payments
[0m12:20:57.079712 [debug] [Thread-2 (]: Writing injected SQL for node "model.upgrade_skills.stg_stripe__payments"
[0m12:20:57.081183 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_stripe__payments (compile): 2023-04-05 12:20:57.066834 => 2023-04-05 12:20:57.081183
[0m12:20:57.082257 [debug] [Thread-2 (]: Began executing node model.upgrade_skills.stg_stripe__payments
[0m12:20:57.086854 [debug] [Thread-2 (]: Timing info for model.upgrade_skills.stg_stripe__payments (execute): 2023-04-05 12:20:57.082755 => 2023-04-05 12:20:57.086854
[0m12:20:57.092984 [debug] [Thread-2 (]: Compilation Error in model stg_stripe__payments (models\staging\stg_stripe__payments.sql)
  No materialization 'default' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:20:57.093984 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05426c31-ef23-4344-90a2-91729b45b678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020204C66A10>]}
[0m12:20:57.095486 [error] [Thread-2 (]: 5 of 8 ERROR creating sql default model DBT_PC_ATOS_staging.stg_stripe__payments  [[31mERROR[0m in 0.03s]
[0m12:20:57.096985 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.stg_stripe__payments
[0m12:20:57.098483 [debug] [Thread-2 (]: Began running node model.upgrade_skills.int_orders
[0m12:20:57.099135 [info ] [Thread-2 (]: 6 of 8 SKIP relation DBT_PC_ATOS_compute.int_orders ............................ [[33mSKIP[0m]
[0m12:20:57.099984 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.int_orders
[0m12:20:57.100615 [debug] [Thread-2 (]: Began running node model.upgrade_skills.fct_customer_orders
[0m12:20:57.101579 [info ] [Thread-2 (]: 7 of 8 SKIP relation DBT_PC_ATOS.fct_customer_orders ........................... [[33mSKIP[0m]
[0m12:20:57.101984 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.fct_customer_orders
[0m12:20:57.102984 [debug] [Thread-2 (]: Began running node model.upgrade_skills.final_model
[0m12:20:57.103287 [info ] [Thread-2 (]: 8 of 8 SKIP relation DBT_PC_ATOS_compute.final_model ........................... [[33mSKIP[0m]
[0m12:20:57.104151 [debug] [Thread-2 (]: Finished running node model.upgrade_skills.final_model
[0m12:20:58.234782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1 seconds
[0m12:20:58.261777 [debug] [Thread-1 (]: Timing info for model.upgrade_skills.customer_orders (execute): 2023-04-05 12:20:56.966765 => 2023-04-05 12:20:58.261777
[0m12:20:58.261777 [debug] [Thread-1 (]: On model.upgrade_skills.customer_orders: Close
[0m12:20:58.505863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05426c31-ef23-4344-90a2-91729b45b678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020204419C50>]}
[0m12:20:58.507144 [info ] [Thread-1 (]: 1 of 8 OK created sql view model DBT_PC_ATOS.customer_orders ................... [[32mSUCCESS 1[0m in 1.56s]
[0m12:20:58.507645 [debug] [Thread-1 (]: Finished running node model.upgrade_skills.customer_orders
[0m12:20:58.510240 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:20:58.511241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:20:58.511741 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was properly closed.
[0m12:20:58.512439 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was properly closed.
[0m12:20:58.512939 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_PC_ATOS_compute' was properly closed.
[0m12:20:58.513287 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_PC_ATOS_staging' was properly closed.
[0m12:20:58.513787 [debug] [MainThread]: Connection 'model.upgrade_skills.customer_orders' was properly closed.
[0m12:20:58.514082 [debug] [MainThread]: Connection 'model.upgrade_skills.stg_stripe__payments' was properly closed.
[0m12:20:58.514610 [info ] [MainThread]: 
[0m12:20:58.515612 [info ] [MainThread]: Finished running 4 default models, 2 table models, 2 view models in 0 hours 0 minutes and 8.19 seconds (8.19s).
[0m12:20:58.516612 [debug] [MainThread]: Command end result
[0m12:20:58.527960 [info ] [MainThread]: 
[0m12:20:58.529454 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m12:20:58.530319 [info ] [MainThread]: 
[0m12:20:58.531008 [error] [MainThread]: [33mCompilation Error in model customers (models\staging\customers.sql)[0m
[0m12:20:58.531747 [error] [MainThread]:   No materialization 'default' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:20:58.532206 [info ] [MainThread]: 
[0m12:20:58.532739 [error] [MainThread]: [33mCompilation Error in model stg_jaffle_shop__customers (models\staging\stg_jaffle_shop__customers.sql)[0m
[0m12:20:58.532739 [error] [MainThread]:   No materialization 'default' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:20:58.533551 [info ] [MainThread]: 
[0m12:20:58.534049 [error] [MainThread]: [33mCompilation Error in model stg_jaffle_shop__orders (models\staging\stg_jaffle_shop__orders.sql)[0m
[0m12:20:58.534644 [error] [MainThread]:   No materialization 'default' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:20:58.535144 [info ] [MainThread]: 
[0m12:20:58.535729 [error] [MainThread]: [33mCompilation Error in model stg_stripe__payments (models\staging\stg_stripe__payments.sql)[0m
[0m12:20:58.535729 [error] [MainThread]:   No materialization 'default' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:20:58.536760 [info ] [MainThread]: 
[0m12:20:58.537259 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=4 SKIP=3 TOTAL=8
[0m12:20:58.537601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202043987D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202043271D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202043277D0>]}
[0m12:20:58.537601 [debug] [MainThread]: Flushing usage events
